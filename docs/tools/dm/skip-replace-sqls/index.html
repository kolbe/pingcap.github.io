<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" name="viewport"/>
<title>Skip or Replace Abnormal SQL Statements | PingCAP</title>
<script>
window.ga =
    window.ga ||
    function() {
        ;(ga.q = ga.q || []).push(arguments)
    }
ga.l = +new Date()
ga('create', 'UA-99991864-4', 'auto')
ga('send', 'pageview')
</script>
<script async="" src="https://download.pingcap.com/js/ga-analytics.js"></script>
<link href="/images/favicon.ico" rel="icon" type="image/x-icon"/>
<link href="/images/favicon.ico" rel="shortcut icon" type="image/x-icon"/>
<link href="/images/apple-touch-icon.png" rel="apple-touch-icon"/>
<link href="https://www.pingcap.com/" rel="canonical"/>
<meta content="Learn how to skip or replace abnormal SQL statements when you use Data Migration." name="description"/>
<meta content="noodp" name="robots"/>
<meta content="SQL, HTAP, Open Source, Cloud-Native, NewSQL" name="keywords"/>
<meta content="en_US" property="og:locale"/>
<meta content="website" property="og:type"/>
<meta content="Skip or Replace Abnormal SQL Statements" property="og:title"/>
<meta content="Learn how to skip or replace abnormal SQL statements when you use Data Migration." property="og:description"/>
<meta content="https://pingcap.com/docs/tools/dm/skip-replace-sqls/" property="og:url"/>
<meta content="PingCAP" property="og:site_name"/>
<meta content="https://pingcap.com/images/pingcap-opengraph.jpg" property="og:image"/>
<meta content="https://pingcap.com/images/pingcap-opengraph.jpg" property="og:image:secure_url"/>
<meta content="summary" name="twitter:card"/>
<meta content="Learn how to skip or replace abnormal SQL statements when you use Data Migration." name="twitter:description"/>
<meta content="Skip or Replace Abnormal SQL Statements" name="twitter:title"/>
<meta content="@pingcap" name="twitter:site"/>
<meta content="https://pingcap.com/images/pingcap-opengraph.jpg" name="twitter:image:src"/>
<meta content="@pingcap" name="twitter:creator"/>
<script async="async" src="//script.crazyegg.com/pages/scripts/0076/9903.js" type="text/javascript"></script>
<script type="application/ld+json">
{
    "@context": "http:\/\/schema.org",
    "@type": "WebSite",
    "url": "https:\/\/www.pingcap.com\/",
    "name": "PingCAP",
    "potentialAction": {
        "@type": "SearchAction",
        "target": "https:\/\/www.pingcap.com\/?s={search_term_string}",
        "query-input": "required name=search_term_string"
    }
}
</script>
<link as="font" crossorigin="anonymous" href="https://download.pingcap.com/fonts/lato/lato-regular-webfont.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="https://download.pingcap.com/fonts/lato/lato-regular-webfont.woff" rel="preload" type="font/woff"/>
<link as="font" crossorigin="anonymous" href="https://download.pingcap.com/fonts/lato/lato-regular-webfont.ttf" rel="preload" type="font/ttf"/>
<link as="font" crossorigin="anonymous" href="https://download.pingcap.com/fonts/titilliumweb/titilliumweb-regular-webfont.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="https://download.pingcap.com/fonts/titilliumweb/titilliumweb-regular-webfont.woff" rel="preload" type="font/woff"/>
<link as="font" crossorigin="anonymous" href="https://download.pingcap.com/fonts/titilliumweb/titilliumweb-regular-webfont.ttf" rel="preload" type="font/ttf"/>
<link as="script" href="https://download.pingcap.com/js/jquery.min.js" rel="preload"/>
<link href="/css/main.css" rel="stylesheet"/>
<link href="https://download.pingcap.com/style/docsearch.min.css" rel="stylesheet"/>
<script type="text/javascript">
var trackOutboundLink = function(url) {
  var redirectTriggered = false
  ga('send', 'event', 'outbound', 'click', url, {
    hitCallback: function() {
      redirectTriggered = true
      document.location = url
    }
  })
  setTimeout(function() {
    if (!redirectTriggered) {
      document.location = url
    }
  }, 1500)
}

var trackViews = function(btn_type, event_category) {
  var event_label = btn_type
  var eventCategory = event_category

  
  ga('send', 'event', {
    'eventCategory': eventCategory,
    'eventAction': 'click',
    'eventLabel': event_label
  });
}
</script>
<style media="screen" type="text/css">
        .st_tree {
            display: none;
        }
    </style>
<link href="https://download.pingcap.com/style/github-markdown.css" rel="stylesheet"/>
<link href="/css/doc.css" rel="stylesheet"/>
<script type="text/javascript">"/"===location.pathname&&"pingcap.github.io"===location.hostname&&(location.href="/en/")</script>
<link as="script" href="/js/app.js" rel="preload"/>
</head><body><style type="text/css">
    .center-element {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        -webkit-transform: translate(-50%, -50%);
    }

    #page-loader {
        transform: translate(-50%, -50%) scale(0.6);
        -webkit-transform: translate(-50%, -50%) scale(0.6);
    }

    #hexagon {
        width: 60px;
        height: auto;
        overflow: visible;
        background-color: transparent;
    }

    #hexagon #hexagon-base,
    #hexagon #hexagon-line-animation {
        fill: transparent;
        stroke-miterlimit: 10;
        stroke-width: 4px;
    }

    #hexagon #hexagon-base {
        stroke: #cdd5e0;
    }

    #hexagon #hexagon-line-animation {
        stroke: #3a59f0;
        stroke-linecap: round;
        animation: dash 1.5s linear;
        animation-iteration-count: infinite;
    }

    @keyframes dash {
        0% {
            stroke-dasharray: 260.22 173.48;
            stroke-dashoffset: 0;
        }
        50% {
            stroke-dasharray: 1 431.7;
        }
        100% {
            stroke-dasharray: 260.22 173.48;
            stroke-dashoffset: -867.4;
        }
    }
</style>
<div class="center-element" id="page-loader">
<svg id="hexagon" viewbox="0 0 129.78 150.37" xmlns="http://www.w3.org/2000/svg">
<path d="M-1665.43,90.94V35.83a15.09,15.09,0,0,1,6.78-12.59l48.22-31.83a15.09,15.09,0,0,1,16-.38L-1547,19.13a15.09,15.09,0,0,1,7.39,13V90.94a15.09,15.09,0,0,1-7.21,12.87l-47.8,29.24a15.09,15.09,0,0,1-15.75,0l-47.8-29.24A15.09,15.09,0,0,1-1665.43,90.94Z" id="hexagon-base" transform="translate(1667.43 13.09)"></path>
<path d="M-1665.43,90.94V35.83a15.09,15.09,0,0,1,6.78-12.59l48.22-31.83a15.09,15.09,0,0,1,16-.38L-1547,19.13a15.09,15.09,0,0,1,7.39,13V90.94a15.09,15.09,0,0,1-7.21,12.87l-47.8,29.24a15.09,15.09,0,0,1-15.75,0l-47.8-29.24A15.09,15.09,0,0,1-1665.43,90.94Z" id="hexagon-line-animation" transform="translate(1667.43 13.09)"></path>
</svg>
</div>
<div id="page-content" style="display:none">
<header class="fixed-top" role="navigation">
<div class="container">
<a class="nav-brand" href="/en"><img alt="PingCAP" src="/images/pingcap-logo.png"/></a>
<div class="nav-wrapper">
<div class="navigation">
<ul>
<li><a class="a-en" href="/tidb-cloud/">Cloud</a></li>
<li><a class="a-en" href="/tidb-academy">TiDB Academy</a></li>
<li class="sel"><a class="a-en" href="/docs">Docs</a></li>
<li><a class="a-en" href="/success-stories">Success
                    Stories</a></li>
<li><a class="a-en" href="/blog">Blog</a></li>
<li><a class="link-download link-download-en" href="/download">Free Download</a></li>
</ul>
</div>
<div class="global-search">
<div class="search-wrapper">
<span class="icon-search"><svg fill="#fff" height="18" viewbox="0 0 67.125 67.125" width="18" xmlns="http://www.w3.org/2000/svg"><path d="M23.902 0C11.01 0 .523 10.488.523 23.38c0 12.891 10.487 23.379 23.379 23.379a23.258 23.258 0 0 0 14.471-5.037l24.816 24.817c.391.391.902.586 1.414.586s1.023-.195 1.414-.586a2 2 0 0 0 0-2.828L41.293 38.985c3.721-4.142 5.989-9.613 5.989-15.605C47.282 10.488 36.794 0 23.902 0zM4.523 23.38C4.523 12.694 13.216 4 23.902 4c10.687 0 19.38 8.694 19.38 19.38 0 5.396-2.221 10.279-5.791 13.795a1.959 1.959 0 0 0-.488.349 2.003 2.003 0 0 0-.271.343C33.31 40.9 28.825 42.76 23.903 42.76c-10.686-.001-19.38-8.695-19.38-19.38z"></path><path d="M24.075 8.591c-8.25 0-14.962 6.712-14.962 14.962a2 2 0 0 0 4 0c0-6.044 4.918-10.962 10.962-10.962a2 2 0 0 0 0-4z"></path></svg></span>
<input data-lang="en" id="search-input" placeholder="Search..." type="search"/>
</div>
</div>
</div>
<div class="nav-btn nav-slider">
<i class="material-icons"><svg height="16" viewbox="0 0 459 459" width="16" xmlns="http://www.w3.org/2000/svg"><path d="M0 382.5h459v-51H0v51zM0 255h459v-51H0v51zM0 76.5v51h459v-51H0z" fill="#FFF"></path></svg></i>
</div>
</div>
</header>
<nav class="mobile-sidebar">
<div class="nav-header">
<div class="logo-wrap">
<a class="nav-brand" href="/en"><img alt="PingCAP" src="/images/pingcap-logo.png"/></a>
</div>
</div>
<ul class="ul-base">
<li><a href="/tidb-cloud/">Cloud</a></li>
<li><a class="tidb-academy" href="/tidb-academy">TiDB Academy</a></li>
<li class="sel"><a href="/docs">Docs</a></li>
<li><a href="/success-stories">Success Stories</a></li>
<li><a href="/blog">Blog</a></li>
<li><a class="link-download" href="/download">Free Download</a></li>
</ul>
<div class="nav-footer">
<div class="contact-list-wrap">
<div class="flex-list">
<h4 class="list-title"><strong>Contact</strong></h4>
<ul class="social ul-base">
<li><a class="twitter" href="https://twitter.com/PingCAP" target="_blank"><svg height="18" viewbox="0 0 612 612" width="18" xmlns="http://www.w3.org/2000/svg"><path d="M612 116.258a250.714 250.714 0 0 1-72.088 19.772c25.929-15.527 45.777-40.155 55.184-69.411-24.322 14.379-51.169 24.82-79.775 30.48-22.907-24.437-55.49-39.658-91.63-39.658-69.334 0-125.551 56.217-125.551 125.513 0 9.828 1.109 19.427 3.251 28.606-104.326-5.24-196.835-55.223-258.75-131.174-10.823 18.51-16.98 40.078-16.98 63.101 0 43.559 22.181 81.993 55.835 104.479a125.556 125.556 0 0 1-56.867-15.756v1.568c0 60.806 43.291 111.554 100.693 123.104-10.517 2.83-21.607 4.398-33.08 4.398-8.107 0-15.947-.803-23.634-2.333 15.985 49.907 62.336 86.199 117.253 87.194-42.947 33.654-97.099 53.655-155.916 53.655-10.134 0-20.116-.612-29.944-1.721 55.567 35.681 121.536 56.485 192.438 56.485 230.948 0 357.188-191.291 357.188-357.188l-.421-16.253c24.666-17.593 46.005-39.697 62.794-64.861z"></path></svg></a></li>
<li><a class="linkedin" href="https://www.linkedin.com/company/pingcap/" target="_blank"><svg height="18" viewbox="0 0 438.536 438.535" width="18" xmlns="http://www.w3.org/2000/svg"><path d="M5.424 145.895H99.64v282.932H5.424zM408.842 171.739c-19.791-21.604-45.967-32.408-78.512-32.408-11.991 0-22.891 1.475-32.695 4.427-9.801 2.95-18.079 7.089-24.838 12.419-6.755 5.33-12.135 10.278-16.129 14.844-3.798 4.337-7.512 9.389-11.136 15.104v-40.232h-93.935l.288 13.706c.193 9.139.288 37.307.288 84.508 0 47.205-.19 108.777-.572 184.722h93.931V270.942c0-9.705 1.041-17.412 3.139-23.127 4-9.712 10.037-17.843 18.131-24.407 8.093-6.572 18.13-9.855 30.125-9.855 16.364 0 28.407 5.662 36.117 16.987 7.707 11.324 11.561 26.98 11.561 46.966V428.82h93.931V266.664c-.007-41.688-9.897-73.328-29.694-94.925zM53.103 9.708c-15.796 0-28.595 4.619-38.4 13.848C4.899 32.787 0 44.441 0 58.529 0 72.42 4.758 84.034 14.275 93.358c9.514 9.325 22.078 13.99 37.685 13.99h.571c15.99 0 28.887-4.661 38.688-13.99 9.801-9.324 14.606-20.934 14.417-34.829-.19-14.087-5.047-25.742-14.561-34.973C81.562 14.323 68.9 9.708 53.103 9.708z"></path></svg></a></li>
<li><a class="reddit" href="https://www.reddit.com/r/TiDB/" target="_blank"><svg height="18" viewbox="0 0 279.748 279.748" width="18" xmlns="http://www.w3.org/2000/svg"><path d="M279.748 133.142c0-19.299-15.701-35-35-35-10.768 0-20.674 4.812-27.279 13.064-18.532-8.431-39.663-13.626-62.015-15.271l19.206-60.692 42.895 9.294c3.285 12.782 14.901 22.258 28.693 22.258 16.336 0 29.627-13.29 29.627-29.626 0-16.336-13.291-29.627-29.627-29.627-11.801 0-21.999 6.941-26.759 16.95l-49.497-10.725a10.002 10.002 0 0 0-11.651 6.756L134.636 95.43c-26.164.638-50.988 6.053-72.356 15.775-6.606-8.251-16.512-13.063-27.28-13.063-19.299 0-35 15.701-35 35 0 9.373 3.683 18.173 10.222 24.709-3.9 8.37-5.875 17.076-5.875 25.936 0 24.048 14.396 46.492 40.538 63.199 25.447 16.264 59.183 25.221 94.989 25.221 35.808 0 69.542-8.957 94.989-25.221 26.142-16.707 40.538-39.151 40.538-63.199 0-8.859-1.975-17.565-5.875-25.936 6.539-6.537 10.222-15.336 10.222-24.709zM15.369 145.139c-2.212-3.59-3.369-7.688-3.369-11.997 0-12.682 10.317-23 23-23 5.444 0 10.558 1.851 14.649 5.258-14.622 8.302-26.132 18.289-34.28 29.739zm52.671 20.266c0-13.785 11.215-25 25-25s25 11.215 25 25-11.215 25-25 25-25-11.215-25-25zm123.119 57.054c-9.745 10.637-29.396 17.244-51.285 17.244-21.888 0-41.539-6.607-51.284-17.244a9.937 9.937 0 0 1-2.617-7.192 9.933 9.933 0 0 1 3.235-6.937 9.974 9.974 0 0 1 6.754-2.627c2.797 0 5.484 1.183 7.373 3.244 5.803 6.333 20.827 10.756 36.539 10.756s30.737-4.423 36.539-10.756a10.022 10.022 0 0 1 7.374-3.244c2.508 0 4.906.933 6.755 2.627a9.928 9.928 0 0 1 3.234 6.937 9.933 9.933 0 0 1-2.617 7.192zm-4.451-32.054c-13.785 0-25-11.215-25-25s11.215-25 25-25 25 11.215 25 25-11.215 25-25 25zm77.671-45.266c-8.147-11.45-19.657-21.436-34.28-29.739 4.092-3.408 9.205-5.258 14.649-5.258 12.683 0 23 10.318 23 23 0 4.309-1.157 8.407-3.369 11.997z"></path></svg></a></li>
<li><a class="google-plus" href="https://groups.google.com/forum/#!forum/tidb-user" target="_blank"><svg height="18" viewbox="0 0 491.858 491.858" width="18" xmlns="http://www.w3.org/2000/svg"><path d="M377.472 224.957H201.319v58.718H308.79c-16.032 51.048-63.714 88.077-120.055 88.077-69.492 0-125.823-56.335-125.823-125.824 0-69.492 56.333-125.823 125.823-125.823 34.994 0 66.645 14.289 89.452 37.346l42.622-46.328c-34.04-33.355-80.65-53.929-132.074-53.929C84.5 57.193 0 141.693 0 245.928s84.5 188.737 188.736 188.737c91.307 0 171.248-64.844 188.737-150.989v-58.718l-.001-.001zM491.858 224.857h-36.031v-36.031h-30.886v36.031H388.91v30.883h36.031v36.032h30.886V255.74h36.031z"></path></svg></a></li>
<li><a class="stack-overflow" href="https://stackoverflow.com/questions/tagged/tidb" target="_blank"><svg height="18" viewbox="0 0 547.597 547.597" width="18" xmlns="http://www.w3.org/2000/svg"><path d="M140.81 475.111h.024l189.91-.269c8.434-.013 15.3-6.886 15.3-15.318v-21.298c0-8.428-6.854-15.288-15.3-15.288l-189.91.264c-8.433.012-15.3 6.885-15.3 15.318v21.31c.001 8.427 6.855 15.281 15.276 15.281z"></path><path d="M58.667 517.854c.073 29.26.073 29.449 3.072 29.449h.055l10.612.294h.086s85.814 0 171.629-.036c42.914-.019 85.821-.05 118-.092 16.09-.019 29.505-.043 38.887-.074 17.803-.055 17.803-.055 17.803-3.072l.3-10.697V333.299c0-8.434-6.866-15.3-15.3-15.3h-11.909c-8.434 0-15.3 6.866-15.3 15.3V496.22c0 5.062-4.119 9.18-9.181 9.18H110.51c-5.061 0-9.18-4.118-9.18-9.18V333.299c0-8.434-6.867-15.3-15.3-15.3H73.82c-8.433 0-15.3 6.86-15.3 15.3 0 23.342.012 76.084.055 122.981.019 23.447.05 45.442.092 61.574z"></path><path d="M142.322 397.399l189.402 17.467c.478.043.948.062 1.413.062 7.956 0 14.468-5.985 15.159-13.917l1.83-21.096c.729-8.396-5.508-15.851-13.898-16.628l-189.102-17.461c-8.593-.795-15.869 5.441-16.653 13.825l-1.97 21.108a15.172 15.172 0 0 0 3.452 11.181 15.19 15.19 0 0 0 10.367 5.459zM437.636 208.849a15.253 15.253 0 0 0 17.694 12.443l21.065-3.678c8.311-1.451 13.898-9.395 12.454-17.706l-32.504-187.23c-1.42-8.207-9.21-13.917-17.692-12.448l-21.065 3.678c-8.311 1.451-13.898 9.395-12.454 17.705l32.502 187.236zM190.333 194.375l163.6 96.708a15.28 15.28 0 0 0 7.778 2.136c5.393 0 10.447-2.876 13.183-7.509l10.876-18.36c2.08-3.519 2.674-7.631 1.658-11.591a15.18 15.18 0 0 0-7.032-9.358l-163.6-96.714c-7.014-4.149-16.836-1.597-20.967 5.374l-10.869 18.36a15.2 15.2 0 0 0-1.658 11.591 15.21 15.21 0 0 0 7.031 9.363zM387.525 240.501a15.276 15.276 0 0 0 12.626 6.659c3.091 0 6.077-.924 8.635-2.681l17.405-11.934c6.953-4.768 8.752-14.314 4.015-21.292L323.29 54.104c-4.584-6.732-14.498-8.623-21.236-3.984l-17.737 12.21c-6.945 4.779-8.727 14.327-3.971 21.291l107.179 156.88zM154.482 302.319l183.465 49.156c1.298.349 2.632.526 3.966.526 6.903 0 12.98-4.67 14.762-11.347l5.508-20.624c2.179-8.152-2.681-16.555-10.826-18.74l-183.465-49.162c-8.017-2.148-16.604 2.852-18.728 10.826l-5.508 20.63c-2.179 8.142 2.68 16.551 10.826 18.735z"></path></svg></a></li>
</ul>
</div>
<div class="subscribe">
<a href="https://share.hsforms.com/1e2W03wLJQQKPd1d9rCbj_Q2npzm"><button class="btn btn-subscribe f-tc" style="margin-left: 0.75rem;">Subscribe to Blog</button></a>
</div>
</div>
<div class="container">
<a class="btn-lang" href="/docs-cn/tools/dm/skip-replace-sqls" id="lang">中文</a>
</div>
</div>
</nav>
<div class="doc">
<div class="container"><div class="sidebar">
<div class="sticky-sidebar">
<div class="title"> Documentation </div>
<div class="st_tree nav-toc"><ul><li class="leaf-child">
<a href="/docs/overview/">Introduction</a>
</li><li class="has-child"><a href="#">Concepts<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs/architecture/">Architecture</a>
</li><li class="has-child"><a href="#">Key Features<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs/key-features/#horizontal-scalability">Horizontal Scalability</a>
</li><li class="leaf-child">
<a href="/docs/key-features/#mysql-compatible-syntax">MySQL Compatible Syntax</a>
</li><li class="leaf-child">
<a href="/docs/key-features/#replicate-from-and-to-mysql">Replicate from and to MySQL</a>
</li><li class="leaf-child">
<a href="/docs/key-features/#distributed-transactions-with-strong-consistency">Distributed Transactions with Strong Consistency</a>
</li><li class="leaf-child">
<a href="/docs/key-features/#cloud-native-architecture">Cloud Native Architecture</a>
</li><li class="leaf-child">
<a href="/docs/key-features/#minimize-etl-with-htap">Minimize ETL with HTAP</a>
</li><li class="leaf-child">
<a href="/docs/key-features/#fault-tolerance--recovery-with-raft">Fault Tolerance &amp; Recovery with Raft</a>
</li><li class="leaf-child">
<a href="/docs/key-features/#automatic-rebalancing">Automatic Rebalancing</a>
</li><li class="leaf-child">
<a href="/docs/key-features/#deployment-and-orchestration-with-ansible-kubernetes-docker">Deployment and Orchestration with Ansible, Kubernetes, Docker</a>
</li><li class="leaf-child">
<a href="/docs/key-features/#json-support">JSON Support</a>
</li><li class="leaf-child">
<a href="/docs/key-features/#spark-integration">Spark Integration</a>
</li><li class="leaf-child">
<a href="/docs/key-features/#read-historical-data-without-restoring-from-backup">Read Historical Data Without Restoring from Backup</a>
</li><li class="leaf-child">
<a href="/docs/key-features/#fast-import-and-restore-of-data">Fast Import and Restore of Data</a>
</li><li class="leaf-child">
<a href="/docs/key-features/#hybrid-of-column-and-row-storage">Hybrid of Column and Row Storage</a>
</li><li class="leaf-child">
<a href="/docs/key-features/#sql-plan-management">SQL Plan Management</a>
</li><li class="leaf-child">
<a href="/docs/key-features/#open-source">Open Source</a>
</li><li class="leaf-child">
<a href="/docs/key-features/#online-schema-changes">Online Schema Changes</a>
</li></ul>
</li></ul>
</li><li class="has-child"><a href="#">How-to<i class="icon-arrow"></i></a><ul><li class="has-child"><a href="#">Get Started<i class="icon-arrow"></i></a><ul><li class="has-child"><a href="#">Start a Local Cluster<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs/dev/how-to/get-started/local-cluster/install-from-binary/">From Binary</a>
</li><li class="leaf-child">
<a href="/docs/dev/how-to/get-started/local-cluster/install-from-homebrew/">From Homebrew</a>
</li><li class="leaf-child">
<a href="/docs/dev/how-to/get-started/local-cluster/install-from-dbdeployer/">From DBdeployer</a>
</li><li class="leaf-child">
<a href="/docs/dev/how-to/get-started/local-cluster/install-from-kubernetes/">In Kubernetes</a>
</li><li class="leaf-child">
<a href="/docs/dev/how-to/get-started/local-cluster/install-from-docker-compose/">In Docker Compose</a>
</li></ul>
</li><li class="leaf-child">
<a href="/docs/dev/how-to/get-started/explore-sql/">Explore SQL with TiDB</a>
</li><li class="leaf-child">
<a href="/docs/dev/how-to/get-started/import-example-database/">Import Example Database</a>
</li><li class="leaf-child">
<a href="/docs/dev/how-to/get-started/read-historical-data/">Read Historical Data</a>
</li></ul>
</li><li class="has-child"><a href="#">Deploy<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs/dev/how-to/deploy/hardware-recommendations/">Hardware Recommendations</a>
</li><li class="has-child"><a href="#">From Binary Tarball<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs/dev/how-to/deploy/from-tarball/testing-environment/">For Testing Environments</a>
</li><li class="leaf-child">
<a href="/docs/dev/how-to/deploy/from-tarball/production-environment/">For Production Environments</a>
</li></ul>
</li><li class="has-child"><a href="#">Orchestrated Deployment<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs/dev/how-to/deploy/orchestrated/ansible/">Ansible Deployment (Recommended)</a>
</li><li class="leaf-child">
<a href="/docs/dev/how-to/deploy/orchestrated/offline-ansible/">Ansible Offline Deployment</a>
</li><li class="leaf-child">
<a href="/docs/dev/how-to/deploy/orchestrated/docker/">Docker Deployment</a>
</li><li class="leaf-child">
<a href="/docs/dev/how-to/deploy/orchestrated/kubernetes/">Kubernetes Deployment</a>
</li><li class="leaf-child">
<a href="/docs/dev/how-to/deploy/orchestrated/ansible-operations/">Overview of Ansible Operations</a>
</li></ul>
</li><li class="has-child"><a href="#">Geographic Redundancy<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs/dev/how-to/deploy/geographic-redundancy/overview/">Overview</a>
</li><li class="leaf-child">
<a href="/docs/dev/how-to/deploy/geographic-redundancy/location-awareness/">Configure Location Awareness</a>
</li></ul>
</li><li class="leaf-child">
<a href="/docs/dev/how-to/deploy/tispark/">TiSpark</a>
</li><li class="leaf-child">
<a href="/docs//tools/dm/deployment/">Data Migration with Ansible</a>
</li></ul>
</li><li class="has-child"><a href="#">Secure<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs/sql/security-compatibility/">Security Compatibility with MySQL</a>
</li><li class="leaf-child">
<a href="/docs/sql/privilege/">The TiDB Access Privilege System</a>
</li><li class="leaf-child">
<a href="/docs/sql/user-account-management/">TiDB User Account Management</a>
</li><li class="has-child"><a href="#">Transport Layer Security (TLS)<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs/sql/encrypted-connections/">Enable TLS For MySQL Clients</a>
</li><li class="leaf-child">
<a href="/docs/op-guide/security/">Enable TLS Between TiDB Components</a>
</li></ul>
</li><li class="leaf-child">
<a href="/docs/op-guide/generate-self-signed-certificates/">Generate Self-signed Certificates</a>
</li></ul>
</li><li class="has-child"><a href="#">Monitor<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs/op-guide/monitor-overview/">Overview</a>
</li><li class="leaf-child">
<a href="/docs/op-guide/monitor/">Monitor a TiDB Cluster</a>
</li><li class="has-child"><a href="#">Key Monitoring Metrics<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs/op-guide/dashboard-overview-info/">Overview</a>
</li><li class="leaf-child">
<a href="/docs/op-guide/tidb-dashboard-info/">TiDB</a>
</li><li class="leaf-child">
<a href="/docs/op-guide/dashboard-pd-info/">PD</a>
</li><li class="leaf-child">
<a href="/docs/op-guide/dashboard-tikv-info/">TiKV</a>
</li></ul>
</li></ul>
</li><li class="has-child"><a href="#">Migrate<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs/op-guide/migration-overview/">Overview</a>
</li><li class="has-child"><a href="#">Migrate from MySQL<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs/op-guide/migration/">Migrate the Full Data</a>
</li><li class="leaf-child">
<a href="/docs/op-guide/migration-incremental/">Migrate the Incremental Data</a>
</li></ul>
</li><li class="leaf-child">
<a href="/docs/tools/lightning/csv/">Migrate from CSV</a>
</li></ul>
</li><li class="has-child"><a href="#">Maintain<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs/op-guide/backup-restore/">Backup and Restore</a>
</li><li class="has-child"><a href="#">Scale<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs/op-guide/horizontal-scale/">Scale a TiDB Cluster</a>
</li><li class="leaf-child">
<a href="/docs/op-guide/ansible-deployment-scale/">Scale Using Ansible</a>
</li></ul>
</li><li class="leaf-child">
<a href="/docs/sql/slow-query/">Identify Slow Queries</a>
</li><li class="has-child"><a href="#">Upgrade<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs/op-guide/tidb-v2.1-upgrade-guide/">Upgrade from TiDB 2.1</a>
</li><li class="leaf-child">
<a href="/docs/tools/dm/dm-upgrade/">Upgrade Data Migration</a>
</li><li class="leaf-child">
<a href="/docs/op-guide/ansible-deployment-rolling-update/">Rolling Updates with Ansible</a>
</li></ul>
</li></ul>
</li><li class="has-child"><a href="#">Troubleshoot<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs/sql/error/">Common Errors</a>
</li><li class="leaf-child">
<a href="/docs/trouble-shooting/">Troubleshoot Cluster Setup</a>
</li><li class="leaf-child">
<a href="/docs/tools/dm/troubleshooting/">Troubleshoot Data Migrations</a>
</li><li class="leaf-child">
<a href="/docs/tools/lightning/errors/">Troubleshoot TiDB-Lightning</a>
</li><li class="leaf-child">
<a href="/docs/support/">Support Resources</a>
</li><li class="leaf-child">
<a href="/docs/report-issue/">Report an Issue</a>
</li></ul>
</li><li class="has-child"><a href="#">Contribute<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs/contribute/#contribute-to-tidb">Contribute to TiDB</a>
</li><li class="leaf-child">
<a href="/docs/contribute/#improve-the-docs">Improve the Docs</a>
</li></ul>
</li></ul>
</li><li class="has-child"><a href="#">Reference<i class="icon-arrow"></i></a><ul><li class="has-child"><a href="#">SQL<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs/sql/connection-and-APIs/">Supported Client Drivers</a>
</li><li class="leaf-child">
<a href="/docs/sql/mysql-compatibility/">MySQL Compatibility</a>
</li><li class="has-child"><a href="#">SQL Statements<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs/sql/ddl/">Data Definition Statements</a>
</li><li class="leaf-child">
<a href="/docs/sql/dml/">Data Manipulation Statements</a>
</li><li class="leaf-child">
<a href="/docs/sql/transaction/">Transactions</a>
</li><li class="leaf-child">
<a href="/docs/sql/admin/">Database Administration Statements</a>
</li><li class="leaf-child">
<a href="/docs/sql/prepare/">Prepared SQL Statement Syntax</a>
</li><li class="leaf-child">
<a href="/docs/sql/util/">Utility Statements</a>
</li><li class="leaf-child">
<a href="https://pingcap.github.io/sqlgram/">TiDB SQL Syntax Diagram</a>
</li></ul>
</li><li class="has-child"><a href="#">Data Types<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs/sql/datatype/#numeric-types">Numeric Types</a>
</li><li class="leaf-child">
<a href="/docs/sql/datatype/#date-and-time-types">Date and Time Types</a>
</li><li class="leaf-child">
<a href="/docs/sql/datatype/#string-types">String Types</a>
</li><li class="leaf-child">
<a href="/docs/sql/datatype/#json-types">JSON Types</a>
</li><li class="leaf-child">
<a href="/docs/sql/datatype/#the-enum-data-type">The ENUM Data Type</a>
</li><li class="leaf-child">
<a href="/docs/sql/datatype/#the-set-type">The SET Type</a>
</li><li class="leaf-child">
<a href="/docs/sql/datatype/#data-type-default-values">Data Type Default Values</a>
</li></ul>
</li><li class="leaf-child">
<a href="/docs/sql/constraints/">Constraints</a>
</li><li class="has-child"><a href="#">Functions and Operators<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs/sql/functions-and-operators-reference/">Function and Operator Reference</a>
</li><li class="leaf-child">
<a href="/docs/sql/type-conversion-in-expression-evaluation/">Type Conversion in Expression Evaluation</a>
</li><li class="leaf-child">
<a href="/docs/sql/operators/">Operators</a>
</li><li class="leaf-child">
<a href="/docs/sql/control-flow-functions/">Control Flow Functions</a>
</li><li class="leaf-child">
<a href="/docs/sql/string-functions/">String Functions</a>
</li><li class="leaf-child">
<a href="/docs/sql/numeric-functions-and-operators/">Numeric Functions and Operators</a>
</li><li class="leaf-child">
<a href="/docs/sql/date-and-time-functions/">Date and Time Functions</a>
</li><li class="leaf-child">
<a href="/docs/sql/bit-functions-and-operators/">Bit Functions and Operators</a>
</li><li class="leaf-child">
<a href="/docs/sql/cast-functions-and-operators/">Cast Functions and Operators</a>
</li><li class="leaf-child">
<a href="/docs/sql/encryption-and-compression-functions/">Encryption and Compression Functions</a>
</li><li class="leaf-child">
<a href="/docs/sql/information-functions/">Information Functions</a>
</li><li class="leaf-child">
<a href="/docs/sql/json-functions/">JSON Functions</a>
</li><li class="leaf-child">
<a href="/docs/sql/aggregate-group-by-functions/">Aggregate (GROUP BY) Functions</a>
</li><li class="leaf-child">
<a href="/docs/sql/miscellaneous-functions/">Miscellaneous Functions</a>
</li><li class="leaf-child">
<a href="/docs/sql/precision-math/">Precision Math</a>
</li></ul>
</li><li class="has-child"><a href="#">SQL Language Structure<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs/sql/literal-values/">Literal Values</a>
</li><li class="leaf-child">
<a href="/docs/sql/schema-object-names/">Schema Object Names</a>
</li><li class="leaf-child">
<a href="/docs/sql/keywords-and-reserved-words/">Keywords and Reserved Words</a>
</li><li class="leaf-child">
<a href="/docs/sql/user-defined-variables/">User-Defined Variables</a>
</li><li class="leaf-child">
<a href="/docs/sql/expression-syntax/">Expression Syntax</a>
</li><li class="leaf-child">
<a href="/docs/sql/comment-syntax/">Comment Syntax</a>
</li></ul>
</li><li class="leaf-child">
<a href="/docs/sql/generated-columns/">Generated Columns</a>
</li><li class="has-child"><a href="#">Transactions<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs/sql/transaction-model/">Transaction Model</a>
</li><li class="leaf-child">
<a href="/docs/sql/transaction-isolation/">Isolation Levels</a>
</li></ul>
</li><li class="has-child"><a href="#">Performance<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs/sql/sql-optimizer-overview/">Overview</a>
</li><li class="leaf-child">
<a href="/docs/sql/understanding-the-query-execution-plan/">Cost-based Optimizer</a>
</li><li class="leaf-child">
<a href="/docs/sql/statistics/">Introduction to Statistics</a>
</li><li class="leaf-child">
<a href="/docs/sql/optimizer-hints/">Optimizer Hints</a>
</li><li class="leaf-child">
<a href="/docs/op-guide/tune-tikv/">Tune TiKV</a>
</li><li class="leaf-child">
<a href="https://pingcap.com/blog/2017-07-24-tidbbestpractice/">TiDB Best Practices</a>
</li></ul>
</li><li class="leaf-child">
<a href="/docs/sql/system-database/">TiDB System Tables</a>
</li><li class="leaf-child">
<a href="/docs/sql/information-schema/">Information Schema</a>
</li><li class="leaf-child">
<a href="/docs/tispark/tispark-user-guide/">TiSpark</a>
</li></ul>
</li><li class="has-child"><a href="#">Configuration<i class="icon-arrow"></i></a><ul><li class="has-child"><a href="#">tidb-server<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs/sql/variable/">MySQL System Variables</a>
</li><li class="leaf-child">
<a href="/docs/sql/tidb-specific/">TiDB Specific System Variables</a>
</li><li class="leaf-child">
<a href="/docs/sql/time-zone/">Time Zone</a>
</li><li class="leaf-child">
<a href="/docs/sql/character-set-support/">Character Set</a>
</li><li class="leaf-child">
<a href="/docs/sql/tidb-memory-control/">Memory Control</a>
</li><li class="leaf-child">
<a href="/docs/op-guide/gc/">Garbage Collection (GC)</a>
</li><li class="leaf-child">
<a href="/docs/op-guide/configuration/">Configuration Flags</a>
</li></ul>
</li><li class="has-child"><a href="#">pd-server<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs/op-guide/pd-configuration/">Configuration Flags</a>
</li></ul>
</li><li class="has-child"><a href="#">tikv-server<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs/op-guide/tikv-configuration/">Configuration Flags</a>
</li></ul>
</li></ul>
</li><li class="has-child"><a href="#">Tools<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs/tools/syncer/">Syncer</a>
</li><li class="leaf-child">
<a href="/docs/tools/mydumper/">mydumper</a>
</li><li class="leaf-child">
<a href="/docs/tools/loader/">Loader</a>
</li><li class="has-child"><a href="#">Data Migration<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs/tools/dm/overview/">Overview</a>
</li><li class="leaf-child">
<a href="/docs/tools/dm/overview/#usage-restrictions">Restrictions</a>
</li><li class="leaf-child">
<a href="/docs/tools/dm/practice/">Deploy</a>
</li><li class="has-child"><a href="#">Features<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs/tools/dm/data-synchronization-features/#table-routing">Table Routing</a>
</li><li class="leaf-child">
<a href="/docs/tools/dm/data-synchronization-features/#black-and-white-table-lists">Black and White Lists</a>
</li><li class="leaf-child">
<a href="/docs/tools/dm/data-synchronization-features/#binlog-event-filtering">Binlog Event Filtering</a>
</li><li class="leaf-child">
<a href="/docs/tools/dm/data-synchronization-features/#column-mapping">Column Mapping</a>
</li><li class="leaf-child">
<a href="/docs/tools/dm/data-synchronization-features/#synchronization-delay-monitoring">Synchronization Delay Monitoring</a>
</li><li class="has-child"><a href="#">Sharding Support<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs/tools/dm/shard-merge/">Introduction</a>
</li><li class="leaf-child">
<a href="/docs/tools/dm/shard-merge/#restrictions">Restrictions</a>
</li><li class="leaf-child">
<a href="/docs/tools/dm/manually-handling-sharding-ddl-locks/">Handle Sharding DDL Locks Manually</a>
</li></ul>
</li></ul>
</li><li class="has-child"><a href="#">Usage Scenarios<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs/tools/dm/simple-synchronization-scenario/">Simple Scenario</a>
</li><li class="leaf-child">
<a href="/docs/tools/dm/shard-merge-scenario/">Shard Merge Scenario</a>
</li></ul>
</li><li class="has-child"><a href="#">Configure<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs/tools/dm/dm-configuration-file-overview/">Overview</a>
</li><li class="leaf-child">
<a href="/docs/tools/dm/task-configuration-file-intro/">Task Configuration</a>
</li></ul>
</li><li class="leaf-child">
<a href="/docs/tools/dm/monitor/">Monitor</a>
</li><li class="leaf-child">
<a href="/docs/tools/dm/manage-task/">Manage the Task</a>
</li><li class="leaf-child">
<a href="/docs/tools/dm/cluster-operations/">Cluster Operations</a>
</li></ul>
</li><li class="has-child"><a href="#">TiDB-Lightning<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs/tools/lightning/overview-architecture/">Overview</a>
</li><li class="leaf-child">
<a href="/docs/tools/lightning/deployment/">Deployment</a>
</li><li class="leaf-child">
<a href="/docs/tools/lightning/checkpoints/">Checkpoints</a>
</li><li class="leaf-child">
<a href="/docs/tools/lightning/filter/">Table Filter</a>
</li><li class="leaf-child">
<a href="/docs/tools/lightning/csv/">CSV Support</a>
</li><li class="leaf-child">
<a href="/docs/tools/lightning/monitor/">Monitor</a>
</li></ul>
</li><li class="leaf-child">
<a href="/docs/tools/tidb-binlog-cluster/">TiDB-Binlog</a>
</li><li class="leaf-child">
<a href="/docs/tools/pd-control/">PD Control</a>
</li><li class="leaf-child">
<a href="/docs/tools/pd-recover/">PD Recover</a>
</li><li class="leaf-child">
<a href="https://github.com/tikv/tikv/blob/master/docs/tools/tikv-control.md">TiKV Control</a>
</li><li class="leaf-child">
<a href="/docs/tools/tidb-controller/">TiDB Controller</a>
</li><li class="leaf-child">
<a href="/docs/tools/download/">Download</a>
</li></ul>
</li><li class="leaf-child">
<a href="/docs/ROADMAP/">Roadmap</a>
</li><li class="leaf-child">
<a href="/docs/adopters/">Adopters</a>
</li></ul>
</li><li class="has-child"><a href="#">FAQs<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs/FAQ/">TiDB FAQs</a>
</li><li class="leaf-child">
<a href="/docs/tools/lightning/faq/">TiDB-Lightning FAQs</a>
</li><li class="leaf-child">
<a href="/docs/op-guide/upgrade-faq/">Upgrade FAQs</a>
</li></ul>
</li><li class="has-child"><a href="#">Releases<i class="icon-arrow"></i></a><ul><li class="has-child"><a href="#">v3.0<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs/releases/3.0.0-beta.1/">3.0.0 Beta.1</a>
</li><li class="leaf-child">
<a href="/docs/releases/3.0beta/">3.0 Beta</a>
</li></ul>
</li><li class="has-child"><a href="#">v2.1<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs/releases/2.1.8/">2.1.8</a>
</li><li class="leaf-child">
<a href="/docs/releases/2.1.7/">2.1.7</a>
</li><li class="leaf-child">
<a href="/docs/releases/2.1.6/">2.1.6</a>
</li><li class="leaf-child">
<a href="/docs/releases/2.1.5/">2.1.5</a>
</li><li class="leaf-child">
<a href="/docs/releases/2.1.4/">2.1.4</a>
</li><li class="leaf-child">
<a href="/docs/releases/2.1.3/">2.1.3</a>
</li><li class="leaf-child">
<a href="/docs/releases/2.1.2/">2.1.2</a>
</li><li class="leaf-child">
<a href="/docs/releases/2.1.1/">2.1.1</a>
</li><li class="leaf-child">
<a href="/docs/releases/2.1ga/">2.1 GA</a>
</li><li class="leaf-child">
<a href="/docs/releases/21rc5/">2.1 RC5</a>
</li><li class="leaf-child">
<a href="/docs/releases/21rc4/">2.1 RC4</a>
</li><li class="leaf-child">
<a href="/docs/releases/21rc3/">2.1 RC3</a>
</li><li class="leaf-child">
<a href="/docs/releases/21rc2/">2.1 RC2</a>
</li><li class="leaf-child">
<a href="/docs/releases/21rc1/">2.1 RC1</a>
</li><li class="leaf-child">
<a href="/docs/releases/21beta/">2.1 Beta</a>
</li></ul>
</li><li class="has-child"><a href="#">v2.0<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs/releases/2.0.11/">2.0.11</a>
</li><li class="leaf-child">
<a href="/docs/releases/2.0.10/">2.0.10</a>
</li><li class="leaf-child">
<a href="/docs/releases/209/">2.0.9</a>
</li><li class="leaf-child">
<a href="/docs/releases/208/">2.0.8</a>
</li><li class="leaf-child">
<a href="/docs/releases/207/">2.0.7</a>
</li><li class="leaf-child">
<a href="/docs/releases/206/">2.0.6</a>
</li><li class="leaf-child">
<a href="/docs/releases/205/">2.0.5</a>
</li><li class="leaf-child">
<a href="/docs/releases/204/">2.0.4</a>
</li><li class="leaf-child">
<a href="/docs/releases/203/">2.0.3</a>
</li><li class="leaf-child">
<a href="/docs/releases/202/">2.0.2</a>
</li><li class="leaf-child">
<a href="/docs/releases/201/">2.0.1</a>
</li><li class="leaf-child">
<a href="/docs/releases/2.0ga/">2.0</a>
</li><li class="leaf-child">
<a href="/docs/releases/2rc5/">2.0 RC5</a>
</li><li class="leaf-child">
<a href="/docs/releases/2rc4/">2.0 RC4</a>
</li><li class="leaf-child">
<a href="/docs/releases/2rc3/">2.0 RC3</a>
</li><li class="leaf-child">
<a href="/docs/releases/2rc1/">2.0 RC1</a>
</li><li class="leaf-child">
<a href="/docs/releases/11beta/">1.1 Beta</a>
</li><li class="leaf-child">
<a href="/docs/releases/11alpha/">1.1 Alpha</a>
</li></ul>
</li><li class="has-child"><a href="#">v1.0<i class="icon-arrow"></i></a><ul><li class="leaf-child">
<a href="/docs/releases/108/">1.0.8</a>
</li><li class="leaf-child">
<a href="/docs/releases/107/">1.0.7</a>
</li><li class="leaf-child">
<a href="/docs/releases/106/">1.0.6</a>
</li><li class="leaf-child">
<a href="/docs/releases/105/">1.0.5</a>
</li><li class="leaf-child">
<a href="/docs/releases/104/">1.0.4</a>
</li><li class="leaf-child">
<a href="/docs/releases/103/">1.0.3</a>
</li><li class="leaf-child">
<a href="/docs/releases/102/">1.0.2</a>
</li><li class="leaf-child">
<a href="/docs/releases/101/">1.0.1</a>
</li><li class="leaf-child">
<a href="/docs/releases/ga/">1.0</a>
</li><li class="leaf-child">
<a href="/docs/releases/prega/">Pre-GA</a>
</li><li class="leaf-child">
<a href="/docs/releases/rc4/">RC4</a>
</li><li class="leaf-child">
<a href="/docs/releases/rc3/">RC3</a>
</li><li class="leaf-child">
<a href="/docs/releases/rc2/">RC2</a>
</li><li class="leaf-child">
<a href="/docs/releases/rc1/">RC1</a>
</li></ul>
</li></ul>
</li></ul>
</div>
</div>
</div>
<div class="archive">
<div class="content markdown-body">
<h1 id="skip-or-replace-abnormal-sql-statements">Skip or Replace Abnormal SQL Statements</h1>
<p>This document introduces how to handle abnormal SQL statements using Data Migration (DM).</p>
<p>Currently, TiDB is not completely compatible with all MySQL syntax (see <a href="/docs/sql/ddl">the DDL statements supported by TiDB</a>). Therefore, when DM is replicating data from MySQL to TiDB and TiDB does not support the corresponding SQL statement, an error might occur and break the replication process. In this case, there are two ways to resume the replication:</p>
<ul>
<li><p>Use dmctl to manually skip the binlog event to which this SQL statement corresponds</p></li>
<li><p>Use dmctl to manually replace the corresponding binlog event with other specified SQL statements that should be executed to the downstream later</p></li>
</ul>
<p>If you know in advance that an unsupported SQL statement is going to be replicated, you can also use dmctl to manually preset the skip or replace operation, which is automatically executed when DM replicates the corresponding binlog event into the downstream and thus avoid breaking the replication.</p>
<h4 id="restrictions">Restrictions</h4>
<ul>
<li><p>The skip or replace operation is a one-time operation that is only used to skip or replace the SQL statement unsupported by the downstream TiDB. Do not handle other replication errors with this approach.</p>
<ul>
<li>For other replication errors, try to handle them using <a href="/docs/tools/dm/data-synchronization-features#black-and-white-table-lists">Black and white table lists</a> or <a href="/docs/tools/dm/data-synchronization-features#binlog-event-filtering">Binlog event filtering</a>.</li>
</ul></li>
<li><p>If it is unacceptable in the actual production environment that the abnormal DDL statement is skipped in the downstream TiDB and it cannot be replaced with other DDL statements, then do not use this approach.</p>
<ul>
<li>For example: <code>DROP PRIMARY KEY</code></li>
<li>In this scenario, you can only create a new table in the downstream with the new table schema (after executing the DDL statement), and re-import all the data into this new table.</li>
</ul></li>
<li><p>A single skip or replace operation targets at a single binlog event.</p></li>
<li><p><code>--sharding</code> is only used to preset the operation to the sharding group. You must preset it before executing the DDL statement and presetting it after executing the DDL is not allowed.</p>
<ul>
<li><code>--sharding</code> only supports presetting operations, and in this mode, you can only use <code>--sql-pattern</code> to match the binlog event.</li>
<li>For the principles of replicating sharding DDL statements using DM, see <a href="/docs/tools/dm/shard-merge#principles">Merge and replicate data from sharded tables</a></li>
</ul></li>
</ul>
<h4 id="match-the-binlog-event">Match the binlog event</h4>
<p>When the replication task gets interrupted because of the SQL execution error, you can obtain the position of the corresponding binlog event by using <code>query-error</code>. When you execute <code>sql-skip</code> or <code>sql-replace</code>, you can specify the position to match the binlog event.</p>
<p>However, when you try to avoid breaking the replication by actively handling unsupported SQL statements, you cannot know in advance the position of the binlog event, so you need another approach to match the subsequent binlog events.</p>
<p>In DM, two modes of matching the binlog event are supported (you can only choose one mode from below):</p>
<ol>
<li><p>binlog position: the position information of the binlog event</p>
<ul>
<li>The binlog position is given by <code>--binlog-pos</code> in the command, and the format is <code>binlog-filename:binlog-pos</code>, for example, <code>mysql-bin|000001.000003:3270</code>.</li>
<li>The format of the binlog filename in DM is not completely consistent with that in the upstream MySQL.</li>
<li>When the replication error occurs, the position can be directly obtained from <code>failedBinlogPosition</code> returned by <code>query-error</code>.</li>
</ul></li>
<li><p>DDL pattern: the regular expression (only for the DDL statement) matching mode</p>
<ul>
<li>The DDL pattern is given by <code>--sql-pattern</code> in the command, for example, to match <code>ALTER TABLE `db2`.`tbl2` DROP COLUMN `c2`</code>, the corresponding regular expression should be <code>~(?i)ALTER\s+TABLE\s+`db2`.`tbl2`\s+DROP\s+COLUMN\s+`c2`</code>.</li>
<li>The regular expression must be prefixed with <code>~</code> and cannot contain any common space (you can replace the space with <code>\s</code> or <code>\s+</code> in the string).</li>
</ul></li>
</ol>
<p>In the scenario of merging and replicating data from sharded tables, if you need DM to automatically select a DDL lock owner to execute the skip or replace operation, then you must use the DDL pattern matching mode because the binlog positions corresponding to the DDL statements on different DM-workers have no logical connection and are hard to confirm.</p>
<blockquote>
<p><strong>Note:</strong></p>
<ul>
<li>You can only register one operator (specified by <code>--binlog-pos</code>) for one binlog event. The previous one can be overwritten by the newly registered operator.</li>
<li>Do not specify an operator for one binlog event by using <code>--binlog-pos</code> and <code>--sql-pattern</code> at the same time.</li>
<li>The operator is deleted once it successfully matches the binlog event (not after the execution succeeds). If you need to match again (using <code>--sql-pattern</code>) later, you have to register a new operator.</li>
</ul>
</blockquote>
<h3 id="supported-scenarios">Supported scenarios</h3>
<ul>
<li><p>Scenario 1: during the replication, the DDL statement unsupported by TiDB is executed in the upstream and replicated to the downstream, and as a result, the replication task gets interrupted.</p>
<ul>
<li>If it is acceptable that this DDL statement is skipped in the downstream TiDB, then you can use <code>sql-skip</code> to resume the replication.</li>
<li>If it is acceptable that this DDL statement is replaced with other DDL statements, then you can use <code>sql-replace</code> to resume the replication.</li>
</ul></li>
<li><p>Scenario 2: during the replication, you know in advance that an unsupported SQL statement is going to be replicated, so you can handle it beforehand to avoid breaking the replication.</p>
<ul>
<li>If it is acceptable that this DDL statement is skipped in the downstream TiDB, then you can use <code>sql-skip</code> to preset an operation to automatically skip this DDL statement when it needs to be executed.</li>
<li>If it is acceptable that this DDL statement is replaced with other DDL statements, then you can use <code>sql-replace</code> to preset an operation to automatically replace this DDL statement when it needs to be executed.</li>
</ul></li>
</ul>
<h3 id="implementation-principles">Implementation principles</h3>
<p>In DM, simplified procedures of incremental data replication can be described as follows:</p>
<ol>
<li><p>The relay unit is used as a slave of the upstream MySQL to fetch the binlog that is persisted in the local storage as the relay log.</p></li>
<li><p>The binlog replication unit (sync) reads the local relay log to obtain the binlog event.</p></li>
<li><p>The binlog replication unit parses the binlog event and builds the DDL/DML statements, and then replicates these statements to the downstream TiDB.</p></li>
</ol>
<p>When the binlog replication unit is parsing the binlog event and replicating data to the downstream, the replication process might get interrupted because the corresponding SQL statement is not supported by TiDB.</p>
<p>In DM, you can register some skip or replace operators for the binlog event. Before replicating the SQL statements to the downstream, DM compares the current binlog event information(position, DDL statement) with registered operators. If the position or the DDL matches with a registered operator, it executes the operation corresponding to the operator and then remove this operator.</p>
<p><strong>Use <code>sql-skip</code> / <code>sql-replace</code> to resume the replication</strong></p>
<ol>
<li><p>Use <code>sql-skip</code> or <code>sql-replace</code> to register an operator for the specified binlog position or DDL pattern.</p></li>
<li><p>Use <code>resume-task</code> to resume the replication task.</p></li>
<li><p>Regain and re-parse the binlog event that causes the replication error.</p></li>
<li><p>The binlog event successfully matches with the registered operator in step 1.</p></li>
<li><p>Execute the skip or replace operation corresponding to the operator and then the replication task continues.</p></li>
</ol>
<p><strong>Use <code>sql-skip</code> / <code>sql-replace</code> to preset operations to avoid breaking the replication</strong></p>
<ol>
<li><p>Use <code>sql-skip</code> or <code>sql-replace</code> to register an operator for the specified DDL pattern.</p></li>
<li><p>Parse the relay log to obtain the binlog event.</p></li>
<li><p>The binlog event (including the SQL statements unsupported by TiDB) successfully matches with the registered operator in step 1.</p></li>
<li><p>Execute the skip or replace operation corresponding to the operator and then the replication task continues and does not get interrupted.</p></li>
</ol>
<p><strong>Use <code>sql-skip</code> / <code>sql-replace</code> to preset operations to avoid breaking the replication in the scenario of merging and replicating data from sharded tables</strong></p>
<ol>
<li><p>Use <code>sql-skip</code> or <code>sql-replace</code> to register an operator (on DM-master) for the specified DDL pattern.</p></li>
<li><p>Each DM-worker parses the relay log to obtain the binlog event.</p></li>
<li><p>DM-master coordinates the DDL lock replication among DM-workers.</p></li>
<li><p>DM-master checks if the DDL lock replication succeeds, and sends the registered operator in step 1 to the DDL lock owner.</p></li>
<li><p>DM-master requests the DDL lock owner to execute the DDL statement.</p></li>
<li><p>The DDL statement that is to be executed by the DDL lock owner successfully matches with the received operator in step 4.</p></li>
<li><p>Execute the skip or replace operation corresponding to the operator and then the replication task continues.</p></li>
</ol>
<h3 id="command">Command</h3>
<p>When you use dmctl to manually handle the SQL statements unsupported by TiDB, the commonly used commands include <code>query-status</code>, <code>query-error</code>, <code>sql-skip</code> and <code>sql-replace</code>.</p>
<h4 id="query-status">query-status</h4>
<p><code>query-status</code> allows you to query the current status of items such as the subtask and the relay unit in each DM-worker. For details, see <a href="/docs/tools/dm/query-status">query status</a>.</p>
<h4 id="query-error">query-error</h4>
<p><code>query-error</code> allows you to query the existing errors of the running subtask and relay unit in DM-workers.</p>
<h5 id="command-usage">Command usage</h5>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">query-error <span style="color:#f92672">[</span>--worker<span style="color:#f92672">=</span><span style="color:#ae81ff">127</span>.0.0.1:8262<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>task-name<span style="color:#f92672">]</span></code></pre></div>
<h5 id="arguments-description">Arguments description</h5>
<ul>
<li><p><code>worker</code>:</p>
<ul>
<li>Flag parameter, string, <code>--worker</code>, optional</li>
<li>If it is not specified, this command queries the errors in all DM-workers; if it is specified, this command queries the error of the specified DM-worker.</li>
</ul></li>
<li><p><code>task-name</code>:</p>
<ul>
<li>Non-flag parameter, string, optional</li>
<li>If it is not specified, this command queries the errors of all tasks; if it is specified, this command queries the error of the specified task.</li>
</ul></li>
</ul>
<h5 id="example-of-results">Example of results</h5>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">» query-error test
<span style="color:#f92672">{</span>
    <span style="color:#e6db74">"result"</span>: true,                              <span style="color:#75715e"># The result of the error query.
</span><span style="color:#75715e"></span>    <span style="color:#e6db74">"msg"</span>: <span style="color:#e6db74">""</span>,                                   <span style="color:#75715e"># The additional message for the failure to the error query.
</span><span style="color:#75715e"></span>    <span style="color:#e6db74">"workers"</span>: <span style="color:#f92672">[</span>                                 <span style="color:#75715e"># The information list of DM-workers.
</span><span style="color:#75715e"></span>        <span style="color:#f92672">{</span>
            <span style="color:#e6db74">"result"</span>: true,                      <span style="color:#75715e"># The result of the error query in this DM-worker.
</span><span style="color:#75715e"></span>            <span style="color:#e6db74">"worker"</span>: <span style="color:#e6db74">"127.0.0.1:8262"</span>,          <span style="color:#75715e"># The IP:port (worker-id) of this DM-worker.
</span><span style="color:#75715e"></span>            <span style="color:#e6db74">"msg"</span>: <span style="color:#e6db74">""</span>,                           <span style="color:#75715e"># The additional message for the failure to the error query in this DM-worker.
</span><span style="color:#75715e"></span>            <span style="color:#e6db74">"subTaskError"</span>: <span style="color:#f92672">[</span>                    <span style="color:#75715e"># The error information of the running subtask in this DM-worker.
</span><span style="color:#75715e"></span>                <span style="color:#f92672">{</span>
                    <span style="color:#e6db74">"name"</span>: <span style="color:#e6db74">"test"</span>,              <span style="color:#75715e"># The task name.
</span><span style="color:#75715e"></span>                    <span style="color:#e6db74">"stage"</span>: <span style="color:#e6db74">"Paused"</span>,           <span style="color:#75715e"># The status of the current task.
</span><span style="color:#75715e"></span>                    <span style="color:#e6db74">"unit"</span>: <span style="color:#e6db74">"Sync"</span>,              <span style="color:#75715e"># The current processing unit of the running task.
</span><span style="color:#75715e"></span>                    <span style="color:#e6db74">"sync"</span>: <span style="color:#f92672">{</span>                    <span style="color:#75715e"># The error information of the binlog replication unit (sync).
</span><span style="color:#75715e"></span>                        <span style="color:#e6db74">"errors"</span>: <span style="color:#f92672">[</span>              <span style="color:#75715e"># The error information list of the current processing unit.
</span><span style="color:#75715e"></span>                            <span style="color:#f92672">{</span>
                                // The error information description.
                                <span style="color:#e6db74">"msg"</span>: <span style="color:#e6db74">"exec sqls[[USE `db1`; ALTER TABLE `db1`.`tbl1` CHANGE COLUMN `c2` `c2` decimal(10,3);]] failed, err:Error 1105: unsupported modify column length 10 is less than origin 11"</span>,
                                // The position of the failed binlog event.
                                <span style="color:#e6db74">"failedBinlogPosition"</span>: <span style="color:#e6db74">"mysql-bin|000001.000003:34642"</span>,
                                // The SQL statement that raises an error.
                                <span style="color:#e6db74">"errorSQL"</span>: <span style="color:#e6db74">"[USE `db1`; ALTER TABLE `db1`.`tbl1` CHANGE COLUMN `c2` `c2` decimal(10,3);]"</span>
                            <span style="color:#f92672">}</span>
                        <span style="color:#f92672">]</span>
                    <span style="color:#f92672">}</span>
                <span style="color:#f92672">}</span>
            <span style="color:#f92672">]</span>,
            <span style="color:#e6db74">"RelayError"</span>: <span style="color:#f92672">{</span>                      <span style="color:#75715e"># The error information of the relay processing unit in this DM-worker.
</span><span style="color:#75715e"></span>                <span style="color:#e6db74">"msg"</span>: <span style="color:#e6db74">""</span>                        <span style="color:#75715e"># The error information description.
</span><span style="color:#75715e"></span>            <span style="color:#f92672">}</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">]</span>
<span style="color:#f92672">}</span></code></pre></div>
<h4 id="sql-skip">sql-skip</h4>
<p><code>sql-skip</code> allows you to preset a skip operation that is to be executed when the position or the SQL statement of the binlog event matches with the specified <code>binlog-pos</code> or <code>sql-pattern</code>.</p>
<h5 id="command-usage-1">Command usage</h5>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sql-skip &lt;--worker<span style="color:#f92672">=</span><span style="color:#ae81ff">127</span>.0.0.1:8262&gt; <span style="color:#f92672">[</span>--binlog-pos<span style="color:#f92672">=</span>mysql-bin|<span style="color:#ae81ff">000001</span>.000003:3270<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--sql-pattern<span style="color:#f92672">=</span>~<span style="color:#f92672">(</span>?i<span style="color:#f92672">)</span>ALTER<span style="color:#ae81ff">\s</span>+TABLE<span style="color:#ae81ff">\s</span>+<span style="color:#e6db74">`</span>db1<span style="color:#e6db74">`</span>.<span style="color:#e6db74">`</span>tbl1<span style="color:#e6db74">`</span><span style="color:#ae81ff">\s</span>+ADD<span style="color:#ae81ff">\s</span>+COLUMN<span style="color:#ae81ff">\s</span>+col1<span style="color:#ae81ff">\s</span>+INT<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--sharding<span style="color:#f92672">]</span> &lt;task-name&gt;</code></pre></div>
<h5 id="arguments-description-1">Arguments description</h5>
<ul>
<li><p><code>worker</code>:</p>
<ul>
<li>Flag parameter, string, <code>--worker</code></li>
<li>If <code>--sharding</code> is not specified, <code>worker</code> is required; if <code>--sharding</code> is specified, <code>worker</code> is forbidden to use.</li>
<li><code>worker</code> specifies the DM-worker in which the presetted operation is going to be executed.</li>
</ul></li>
<li><p><code>binlog-pos</code>:</p>
<ul>
<li>Flag parameter, string, <code>--binlog-pos</code></li>
<li>You must specify <code>binlog-pos</code> or <code>--sql-pattern</code>, and you must not specify both.</li>
<li>If it is specified, the skip operation is executed when <code>binlog-pos</code> matches with the position of the binlog event. The format is <code>binlog-filename:binlog-pos</code>, for example, <code>mysql-bin|000001.000003:3270</code>.</li>
<li>When the replication error occurs, the position can be obtained from <code>failedBinlogPosition</code>  returned by <code>query-error</code>.</li>
</ul></li>
<li><p><code>sql-pattern</code>:</p>
<ul>
<li>Flag parameter, string, <code>--sql-pattern</code></li>
<li>You must specify <code>--sql-pattern</code> or <code>binlog-pos</code>, and you must not specify both.</li>
<li>If it is specified, the skip operation is executed when <code>sql-pattern</code> matches with the DDL statement (converted by the optional router-rule) of the binlog event. The format is a regular expression prefixed with <code>~</code>, for example, <code>~(?i)ALTER\s+TABLE\s+`db1`.`tbl1`\s+ADD\s+COLUMN\s+col1\s+INT</code>.

<ul>
<li>Common spaces are not supported in the regular expression temporarily. You can replace the space with <code>\s</code> or <code>\s+</code> if it is needed.</li>
<li>The regular expression must be prefixed with <code>~</code>. For details, see <a href="https://golang.org/pkg/regexp/syntax/#hdr-Syntax">regular expression syntax</a>.</li>
<li>The schema/table name in the regular expression must be converted by the optional router-rule, so the converted name is consistent with the target schema/table name in the downstream. For example, if there are <code>`shard_db_1`.`shard_tbl_1`</code> in the upstream and <code>`shard_db`.`shard_tbl`</code> in the downstream, then you should match <code>`shard_db`.`shard_tbl`</code>.</li>
<li>The schema/table/column name in the regular expression should be marked by <code>`</code>, for example, <code>`db1`.`tbl1`</code>.</li>
</ul></li>
</ul></li>
<li><p><code>sharding</code>:</p>
<ul>
<li>Flag parameter, boolean, <code>--sharding</code></li>
<li>If <code>--worker</code> is not specified, <code>sharding</code> is required; if <code>--worker</code> is specified, <code>sharding</code> is forbidden to use.</li>
<li>If <code>sharding</code> is specified, it indicates that the presetted operation is going to be executed in the DDL lock owner during the sharding DDL replication.</li>
</ul></li>
<li><p><code>task-name</code>:</p>
<ul>
<li>Non-flag parameter, string, required</li>
<li><code>task-name</code> specifies the name of the task in which the presetted operation is going to be executed.</li>
</ul></li>
</ul>
<h4 id="sql-replace">sql-replace</h4>
<p><code>sql-replace</code> allows you to preset a replace operation that is to be executed when the position or the SQL statement of the binlog event matches with the specified <code>binlog-pos</code> or <code>sql-pattern</code>.</p>
<h5 id="command-usage-2">Command usage</h5>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sql-replace &lt;--worker<span style="color:#f92672">=</span><span style="color:#ae81ff">127</span>.0.0.1:8262&gt; <span style="color:#f92672">[</span>--binlog-pos<span style="color:#f92672">=</span>mysql-bin|<span style="color:#ae81ff">000001</span>.000003:3270<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--sql-pattern<span style="color:#f92672">=</span>~<span style="color:#f92672">(</span>?i<span style="color:#f92672">)</span>ALTER<span style="color:#ae81ff">\s</span>+TABLE<span style="color:#ae81ff">\s</span>+<span style="color:#e6db74">`</span>db1<span style="color:#e6db74">`</span>.<span style="color:#e6db74">`</span>tbl1<span style="color:#e6db74">`</span><span style="color:#ae81ff">\s</span>+ADD<span style="color:#ae81ff">\s</span>+COLUMN<span style="color:#ae81ff">\s</span>+col1<span style="color:#ae81ff">\s</span>+INT<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--sharding<span style="color:#f92672">]</span> &lt;task-name&gt; &lt;SQL-1;SQL-2&gt;</code></pre></div>
<h5 id="arguments-description-2">Arguments description</h5>
<ul>
<li><p><code>worker</code>:</p>
<ul>
<li>same with <code>--worker</code> of <code>sql-skip</code></li>
</ul></li>
<li><p><code>binlog-pos</code>:</p>
<ul>
<li>same with <code>--binlog-pos</code> of <code>sql-skip</code></li>
</ul></li>
<li><p><code>sql-pattern</code>:</p>
<ul>
<li>same with <code>--sql-pattern</code> of <code>sql-skip</code></li>
</ul></li>
<li><p><code>sharding</code>:</p>
<ul>
<li>same with <code>--sharding</code> of <code>sql-skip</code></li>
</ul></li>
<li><p><code>task-name</code>:</p>
<ul>
<li>same with <code>task-name</code> of <code>sql-skip</code></li>
</ul></li>
<li><p><code>SQLs</code>:</p>
<ul>
<li>Non-flag parameter, string, required</li>
<li><code>SQLs</code> specifies the new SQL statements that are going to replace the original binlog event. You should separate multiple SQL statements with <code>;</code>, for example, <code>ALTER TABLE shard_db.shard_table drop index idx_c2;ALTER TABLE shard_db.shard_table DROP COLUMN c2;</code>.</li>
</ul></li>
</ul>
<h3 id="usage-examples">Usage examples</h3>
<h4 id="passively-skip-after-the-replication-gets-interrupted">Passively skip after the replication gets interrupted</h4>
<h5 id="application-scenario">Application scenario</h5>
<p>Assume that you need to replicate the upstream table <code>db1.tbl1</code> to the downstream TiDB (not in the scenario of merging and replicating data from sharded tables). The initial table schema is:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">mysql<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">SHOW</span> <span style="color:#66d9ef">CREATE</span> <span style="color:#66d9ef">TABLE</span> db1.tbl1;
<span style="color:#f92672">+</span><span style="color:#75715e">-------+--------------------------------------------------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span> <span style="color:#66d9ef">Table</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">Create</span> <span style="color:#66d9ef">Table</span>                                     <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">-------+--------------------------------------------------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span> tbl1  <span style="color:#f92672">|</span> <span style="color:#66d9ef">CREATE</span> <span style="color:#66d9ef">TABLE</span> <span style="color:#f92672">`</span>tbl1<span style="color:#f92672">`</span> (
  <span style="color:#f92672">`</span>c1<span style="color:#f92672">`</span> int(<span style="color:#ae81ff">11</span>) <span style="color:#66d9ef">NOT</span> <span style="color:#66d9ef">NULL</span>,
  <span style="color:#f92672">`</span>c2<span style="color:#f92672">`</span> decimal(<span style="color:#ae81ff">11</span>,<span style="color:#ae81ff">3</span>) <span style="color:#66d9ef">DEFAULT</span> <span style="color:#66d9ef">NULL</span>,
  <span style="color:#66d9ef">PRIMARY</span> <span style="color:#66d9ef">KEY</span> (<span style="color:#f92672">`</span>c1<span style="color:#f92672">`</span>)
) ENGINE<span style="color:#f92672">=</span>InnoDB <span style="color:#66d9ef">DEFAULT</span> CHARSET<span style="color:#f92672">=</span>latin1 <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">-------+--------------------------------------------------+</span></code></pre></div>
<p>Now, the following DDL statement is executed in the upstream to alter the table schema (namely, alter DECIMAL(11, 3) of c2 into DECIMAL(10, 3)):</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">ALTER</span> <span style="color:#66d9ef">TABLE</span> db1.tbl1 CHANGE c2 c2 DECIMAL (<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">3</span>);</code></pre></div>
<p>Because this DDL statement is not supported by TiDB, the replication task of DM gets interrupted and reports the following error:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">exec sqls<span style="color:#f92672">[[</span>USE <span style="color:#e6db74">`</span>db1<span style="color:#e6db74">`</span>; ALTER TABLE <span style="color:#e6db74">`</span>db1<span style="color:#e6db74">`</span>.<span style="color:#e6db74">`</span>tbl1<span style="color:#e6db74">`</span> CHANGE COLUMN <span style="color:#e6db74">`</span>c2<span style="color:#e6db74">`</span> <span style="color:#e6db74">`</span>c2<span style="color:#e6db74">`</span> decimal<span style="color:#f92672">(</span><span style="color:#ae81ff">10</span>,3<span style="color:#f92672">)</span>;<span style="color:#f92672">]]</span> failed, 
err:Error <span style="color:#ae81ff">1105</span>: unsupported modify column length <span style="color:#ae81ff">10</span> is less than origin <span style="color:#ae81ff">11</span></code></pre></div>
<p>Now, if you query the status of the task using <code>query-status</code>, you can see that <code>stage</code> has changed into <code>Paused</code> and there is some related error description information in <code>errors</code>.</p>
<p>To obtain the details about the error, you should use <code>query-error</code>. For example, you can execute <code>query-error test</code> to get the position of the failed binlog event (<code>failedBinlogPosition</code>), which is <code>mysql-bin|000001.000003:34642</code>.</p>
<h5 id="passively-skip-the-sql-statement">Passively skip the SQL statement</h5>
<p>Assume that it is acceptable in the actual production environment that this DDL statement is not executed in the downstream TiDB (namely, the original table schema is retained). Then you can use <code>sql-skip</code> to skip this DDL statement to resume the replication. The procedures are as follows:</p>
<ol>
<li><p>Use <code>query-error</code> to obtain the position of the failed binlog event.</p>
<ul>
<li>You can get the position from <code>failedBinlogPosition</code> returned by <code>query-error</code>.</li>
<li>In this example, the position is <code>mysql-bin|000001.000003:34642</code>.</li>
</ul></li>
<li><p>Use <code>sql-skip</code> to preset a skip operation that is to be executed when DM replicates this binlog event to the downstream after using <code>resume-task</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">» sql-skip --worker<span style="color:#f92672">=</span><span style="color:#ae81ff">127</span>.0.0.1:8262 --binlog-pos<span style="color:#f92672">=</span>mysql-bin|<span style="color:#ae81ff">000001</span>.000003:34642 test
<span style="color:#f92672">{</span>
    <span style="color:#e6db74">"result"</span>: true,
    <span style="color:#e6db74">"msg"</span>: <span style="color:#e6db74">""</span>,
    <span style="color:#e6db74">"workers"</span>: <span style="color:#f92672">[</span>
        <span style="color:#f92672">{</span>
            <span style="color:#e6db74">"result"</span>: true,
            <span style="color:#e6db74">"worker"</span>: <span style="color:#e6db74">""</span>,
            <span style="color:#e6db74">"msg"</span>: <span style="color:#e6db74">""</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">]</span>
<span style="color:#f92672">}</span></code></pre></div>
<p>You can also view the following log in the corresponding DM-worker node:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#ae81ff">2018</span>/12/28 <span style="color:#ae81ff">11</span>:17:51 operator.go:121: <span style="color:#f92672">[</span>info<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>sql-operator<span style="color:#f92672">]</span> set a new operator 
uuid: 6bfcf30f-2841-4d70-9a34-28d7082bdbd7, pos: <span style="color:#f92672">(</span>mysql-bin|<span style="color:#ae81ff">000001</span>.000003, <span style="color:#ae81ff">34642</span><span style="color:#f92672">)</span>, op: SKIP, args:
on replication unit</code></pre></div></li>
<li><p>Use <code>resume-task</code> to resume the replication task</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">» resume-task --worker<span style="color:#f92672">=</span><span style="color:#ae81ff">127</span>.0.0.1:8262 test
<span style="color:#f92672">{</span>
    <span style="color:#e6db74">"op"</span>: <span style="color:#e6db74">"Resume"</span>,
    <span style="color:#e6db74">"result"</span>: true,
    <span style="color:#e6db74">"msg"</span>: <span style="color:#e6db74">""</span>,
    <span style="color:#e6db74">"workers"</span>: <span style="color:#f92672">[</span>
        <span style="color:#f92672">{</span>
            <span style="color:#e6db74">"op"</span>: <span style="color:#e6db74">"Resume"</span>,
            <span style="color:#e6db74">"result"</span>: true,
            <span style="color:#e6db74">"worker"</span>: <span style="color:#e6db74">"127.0.0.1:8262"</span>,
            <span style="color:#e6db74">"msg"</span>: <span style="color:#e6db74">""</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">]</span>
<span style="color:#f92672">}</span></code></pre></div>
<p>You can also view the following log in the corresponding DM-worker node:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#ae81ff">2018</span>/12/28 <span style="color:#ae81ff">11</span>:27:46 operator.go:158: <span style="color:#f92672">[</span>info<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>sql-operator<span style="color:#f92672">]</span> binlog-pos <span style="color:#f92672">(</span>mysql-bin|<span style="color:#ae81ff">000001</span>.000003, <span style="color:#ae81ff">34642</span><span style="color:#f92672">)</span> matched, 
applying operator uuid: 6bfcf30f-2841-4d70-9a34-28d7082bdbd7, pos: <span style="color:#f92672">(</span>mysql-bin|<span style="color:#ae81ff">000001</span>.000003, <span style="color:#ae81ff">34642</span><span style="color:#f92672">)</span>, op: SKIP, args:</code></pre></div></li>
<li><p>Use <code>query-status</code> to guarantee that the <code>stage</code> of the task has changed into <code>Running</code>.</p></li>
<li><p>Use <code>query-error</code> to guarantee that no DDL execution error exists.</p></li>
</ol>
<h4 id="actively-replace-before-the-replication-gets-interrupted">Actively replace before the replication gets interrupted</h4>
<h5 id="application-scenario-1">Application scenario</h5>
<p>Assume that you need to replicate the upstream table <code>db2.tbl2</code> to the downstream TiDB (not in the scenario of merging and replicating data from sharded tables). The initial table schema is:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">mysql<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">SHOW</span> <span style="color:#66d9ef">CREATE</span> <span style="color:#66d9ef">TABLE</span> db2.tbl2;
<span style="color:#f92672">+</span><span style="color:#75715e">-------+--------------------------------------------------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span> <span style="color:#66d9ef">Table</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">Create</span> <span style="color:#66d9ef">Table</span>                                     <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">-------+--------------------------------------------------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span> tbl2  <span style="color:#f92672">|</span> <span style="color:#66d9ef">CREATE</span> <span style="color:#66d9ef">TABLE</span> <span style="color:#f92672">`</span>tbl2<span style="color:#f92672">`</span> (
  <span style="color:#f92672">`</span>c1<span style="color:#f92672">`</span> int(<span style="color:#ae81ff">11</span>) <span style="color:#66d9ef">NOT</span> <span style="color:#66d9ef">NULL</span>,
  <span style="color:#f92672">`</span>c2<span style="color:#f92672">`</span> int(<span style="color:#ae81ff">11</span>) <span style="color:#66d9ef">DEFAULT</span> <span style="color:#66d9ef">NULL</span>,
  <span style="color:#66d9ef">PRIMARY</span> <span style="color:#66d9ef">KEY</span> (<span style="color:#f92672">`</span>c1<span style="color:#f92672">`</span>),
  <span style="color:#66d9ef">KEY</span> <span style="color:#f92672">`</span>idx_c2<span style="color:#f92672">`</span> (<span style="color:#f92672">`</span>c2<span style="color:#f92672">`</span>)
) ENGINE<span style="color:#f92672">=</span>InnoDB <span style="color:#66d9ef">DEFAULT</span> CHARSET<span style="color:#f92672">=</span>latin1 <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">-------+--------------------------------------------------+</span></code></pre></div>
<p>Now, the following DDL statement is executed in the upstream to alter the table schema (namely, <code>DROP COLUMN c2</code>):</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">ALTER</span> <span style="color:#66d9ef">TABLE</span> db2.tbl2 <span style="color:#66d9ef">DROP</span> <span style="color:#66d9ef">COLUMN</span> c2;</code></pre></div>
<p>Because this DDL statement is not supported by TiDB, the replication task of DM gets interrupted and reports the following error:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">exec sqls<span style="color:#f92672">[[</span>USE <span style="color:#e6db74">`</span>db2<span style="color:#e6db74">`</span>; ALTER TABLE <span style="color:#e6db74">`</span>db2<span style="color:#e6db74">`</span>.<span style="color:#e6db74">`</span>tbl2<span style="color:#e6db74">`</span> DROP COLUMN <span style="color:#e6db74">`</span>c2<span style="color:#e6db74">`</span>;<span style="color:#f92672">]]</span> failed, 
err:Error <span style="color:#ae81ff">1105</span>: can<span style="color:#960050;background-color:#1e0010">'</span>t drop column c2 with index covered now</code></pre></div>
<p><strong>Assume that you know in advance that this DDL statement is not supported by TiDB before it is executed in the upstream.</strong> Then you can use <code>sql-skip</code> or <code>sql-replace</code> to preset a skip or replace operation for this DDL statement.</p>
<p>For this particular DDL statement, because dropping columns with the index is not temporarily supported by TiDB, you can use two new SQL statements to replace the original DDL, namely, DROP the index first and then DROP the column c2.</p>
<h5 id="actively-replace-the-sql-statement">Actively replace the SQL statement</h5>
<ol>
<li><p>Design a matchable regular expression for the DDL statement (converted by the optional router-rule) to be executed in the upstream.</p>
<ul>
<li>The DDL statement to be executed in the upstream is <code>ALTER TABLE db2.tbl2 DROP COLUMN c2;</code>.</li>
<li><p>Because its router-rule conversion does not exist, you can design the following regular expression:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#f92672">~</span>(<span style="color:#f92672">?</span>i)<span style="color:#66d9ef">ALTER</span><span style="color:#960050;background-color:#1e0010">\</span>s<span style="color:#f92672">+</span><span style="color:#66d9ef">TABLE</span><span style="color:#960050;background-color:#1e0010">\</span>s<span style="color:#f92672">+`</span>db2<span style="color:#f92672">`</span>.<span style="color:#f92672">`</span>tbl2<span style="color:#f92672">`</span><span style="color:#960050;background-color:#1e0010">\</span>s<span style="color:#f92672">+</span><span style="color:#66d9ef">DROP</span><span style="color:#960050;background-color:#1e0010">\</span>s<span style="color:#f92672">+</span><span style="color:#66d9ef">COLUMN</span><span style="color:#960050;background-color:#1e0010">\</span>s<span style="color:#f92672">+`</span>c2<span style="color:#f92672">`</span></code></pre></div></li>
</ul></li>
<li><p>Build new DDL statements that are used to replace this original DDL statement.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">ALTER</span> <span style="color:#66d9ef">TABLE</span> <span style="color:#f92672">`</span>db2<span style="color:#f92672">`</span>.<span style="color:#f92672">`</span>tbl2<span style="color:#f92672">`</span> <span style="color:#66d9ef">DROP</span> <span style="color:#66d9ef">INDEX</span> idx_c2;<span style="color:#66d9ef">ALTER</span> <span style="color:#66d9ef">TABLE</span> <span style="color:#f92672">`</span>db2<span style="color:#f92672">`</span>.<span style="color:#f92672">`</span>tbl2<span style="color:#f92672">`</span> <span style="color:#66d9ef">DROP</span> <span style="color:#66d9ef">COLUMN</span> <span style="color:#f92672">`</span>c2<span style="color:#f92672">`</span></code></pre></div></li>
<li><p>Use <code>sql-replace</code> to preset a replace operation that is to be executed when DM replicates the corresponding binlog event to the downstream.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">» sql-replace --worker<span style="color:#f92672">=</span><span style="color:#ae81ff">127</span>.0.0.1:8262 --sql-pattern<span style="color:#f92672">=</span>~<span style="color:#f92672">(</span>?i<span style="color:#f92672">)</span>ALTER<span style="color:#ae81ff">\s</span>+TABLE<span style="color:#ae81ff">\s</span>+<span style="color:#e6db74">`</span>db2<span style="color:#e6db74">`</span>.<span style="color:#e6db74">`</span>tbl2<span style="color:#e6db74">`</span><span style="color:#ae81ff">\s</span>+DROP<span style="color:#ae81ff">\s</span>+COLUMN<span style="color:#ae81ff">\s</span>+<span style="color:#e6db74">`</span>c2<span style="color:#e6db74">`</span> test ALTER TABLE <span style="color:#e6db74">`</span>db2<span style="color:#e6db74">`</span>.<span style="color:#e6db74">`</span>tbl2<span style="color:#e6db74">`</span> DROP INDEX idx_c2;ALTER TABLE <span style="color:#e6db74">`</span>db2<span style="color:#e6db74">`</span>.<span style="color:#e6db74">`</span>tbl2<span style="color:#e6db74">`</span> DROP COLUMN <span style="color:#e6db74">`</span>c2<span style="color:#e6db74">`</span>
<span style="color:#f92672">{</span>
    <span style="color:#e6db74">"result"</span>: true,
    <span style="color:#e6db74">"msg"</span>: <span style="color:#e6db74">""</span>,
    <span style="color:#e6db74">"workers"</span>: <span style="color:#f92672">[</span>
        <span style="color:#f92672">{</span>
            <span style="color:#e6db74">"result"</span>: true,
            <span style="color:#e6db74">"worker"</span>: <span style="color:#e6db74">""</span>,
            <span style="color:#e6db74">"msg"</span>: <span style="color:#e6db74">""</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">]</span>
<span style="color:#f92672">}</span></code></pre></div>
<p>You can also view the following log in the corresponding DM-worker node:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#ae81ff">2018</span>/12/28 <span style="color:#ae81ff">15</span>:33:13 operator.go:121: <span style="color:#f92672">[</span>info<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>sql-operator<span style="color:#f92672">]</span> set a new operator 
uuid: c699a18a-8e75-47eb-8e7e-0e5abde2053c, pattern: ~<span style="color:#f92672">(</span>?i<span style="color:#f92672">)</span>ALTER<span style="color:#ae81ff">\s</span>+TABLE<span style="color:#ae81ff">\s</span>+<span style="color:#e6db74">`</span>db2<span style="color:#e6db74">`</span>.<span style="color:#e6db74">`</span>tbl2<span style="color:#e6db74">`</span><span style="color:#ae81ff">\s</span>+DROP<span style="color:#ae81ff">\s</span>+COLUMN<span style="color:#ae81ff">\s</span>+<span style="color:#e6db74">`</span>c2<span style="color:#e6db74">`</span>, 
op: REPLACE, args: ALTER TABLE <span style="color:#e6db74">`</span>db2<span style="color:#e6db74">`</span>.<span style="color:#e6db74">`</span>tbl2<span style="color:#e6db74">`</span> DROP INDEX idx_c2; ALTER TABLE <span style="color:#e6db74">`</span>db2<span style="color:#e6db74">`</span>.<span style="color:#e6db74">`</span>tbl2<span style="color:#e6db74">`</span> DROP COLUMN <span style="color:#e6db74">`</span>c2<span style="color:#e6db74">`</span>
on replication unit</code></pre></div></li>
<li><p>Execute the DDL statements in the upstream MySQL.</p></li>
<li><p>Check if the downstream table schema is altered successfully, and you can view the following log in the corresponding DM-worker node:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#ae81ff">2018</span>/12/28 <span style="color:#ae81ff">15</span>:33:45 operator.go:158: <span style="color:#f92672">[</span>info<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>sql-operator<span style="color:#f92672">]</span> 
sql-pattern ~<span style="color:#f92672">(</span>?i<span style="color:#f92672">)</span>ALTER<span style="color:#ae81ff">\s</span>+TABLE<span style="color:#ae81ff">\s</span>+<span style="color:#e6db74">`</span>db2<span style="color:#e6db74">`</span>.<span style="color:#e6db74">`</span>tbl2<span style="color:#e6db74">`</span><span style="color:#ae81ff">\s</span>+DROP<span style="color:#ae81ff">\s</span>+COLUMN<span style="color:#ae81ff">\s</span>+<span style="color:#e6db74">`</span>c2<span style="color:#e6db74">`</span> matched SQL 
USE <span style="color:#e6db74">`</span>db2<span style="color:#e6db74">`</span>; ALTER TABLE <span style="color:#e6db74">`</span>db2<span style="color:#e6db74">`</span>.<span style="color:#e6db74">`</span>tbl2<span style="color:#e6db74">`</span> DROP COLUMN <span style="color:#e6db74">`</span>c2<span style="color:#e6db74">`</span>;, 
applying operator uuid: c699a18a-8e75-47eb-8e7e-0e5abde2053c, 
pattern: ~<span style="color:#f92672">(</span>?i<span style="color:#f92672">)</span>ALTER<span style="color:#ae81ff">\s</span>+TABLE<span style="color:#ae81ff">\s</span>+<span style="color:#e6db74">`</span>db2<span style="color:#e6db74">`</span>.<span style="color:#e6db74">`</span>tbl2<span style="color:#e6db74">`</span><span style="color:#ae81ff">\s</span>+DROP<span style="color:#ae81ff">\s</span>+COLUMN<span style="color:#ae81ff">\s</span>+<span style="color:#e6db74">`</span>c2<span style="color:#e6db74">`</span>, 
op: REPLACE, args: ALTER TABLE <span style="color:#e6db74">`</span>db2<span style="color:#e6db74">`</span>.<span style="color:#e6db74">`</span>tbl2<span style="color:#e6db74">`</span> DROP INDEX idx_c2; ALTER TABLE <span style="color:#e6db74">`</span>db2<span style="color:#e6db74">`</span>.<span style="color:#e6db74">`</span>tbl2<span style="color:#e6db74">`</span> DROP COLUMN <span style="color:#e6db74">`</span>c2<span style="color:#e6db74">`</span></code></pre></div></li>
<li><p>Use <code>query-status</code> to guarantee that the <code>stage</code> of the task has been sustained as <code>Running</code>.</p></li>
<li><p>Use <code>query-error</code> to guarantee that no DDL execution error exists.</p></li>
</ol>
<h4 id="passively-skip-after-the-replication-gets-interrupted-in-the-scenario-of-merging-and-replicating-data-from-sharded-tables">Passively skip after the replication gets interrupted in the scenario of merging and replicating data from sharded tables</h4>
<h5 id="application-scenario-2">Application scenario</h5>
<p>Assume that you need to merge and replicate multiple tables in multiple upstream MySQL instances to one same table in the downstream TiDB through multiple DM-workers. And the DDL statement unsupported by TiDB is executed to the upstream sharded tables.</p>
<p>After DM-master coordinates the DDL replication through the DDL lock and requests the DDL lock owner to execute the DDL statement to the downstream, the replication gets interrupted because this DDL statement is not supported by TiDB.</p>
<h5 id="passively-skip-the-sql-statement-1">Passively skip the SQL statement</h5>
<p>In the scenario of merging and replicating data from sharded tables, passively skipping the unsupported DDL statement has the similar steps with <a href="#passively-skip-after-the-replication-gets-interrupted">Passively skip after the replication gets interrupted</a>.</p>
<p>There are two major differences between the two scenarios as follows. In the scenario of merging and replicating data from sharded tables:</p>
<ol>
<li><p>You just need the DDL lock owner to execute <code>sql-skip</code> (<code>--worker={DDL-lock-owner}</code>).</p></li>
<li><p>You just need the DDL lock owner to execute <code>resume-task</code> (<code>--worker={DDL-lock-owner}</code>).</p></li>
</ol>
<h4 id="actively-replace-before-the-replication-gets-interrupted-in-the-scenario-of-merging-and-replicating-data-from-sharded-tables">Actively replace before the replication gets interrupted in the scenario of merging and replicating data from sharded tables</h4>
<h5 id="application-scenario-3">Application scenario</h5>
<p>Assume that you need to merge and replicate the following four tables in the upstream to one same table <code>`shard_db`.`shard_table`</code> in the downstream:</p>
<ul>
<li>In the MySQL instance 1, there is a schema <code>shard_db_1</code>, which has two tables <code>shard_table_1</code> and <code>shard_table_2</code>.</li>
<li>In the MySQL instance 2, there is a schema <code>shard_db_2</code>, which has two tables <code>shard_table_1</code> and <code>shard_table_2</code>.</li>
</ul>
<p>The initial table schema is:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">mysql<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">SHOW</span> <span style="color:#66d9ef">CREATE</span> <span style="color:#66d9ef">TABLE</span> shard_db_1.shard_table_1;
<span style="color:#f92672">+</span><span style="color:#75715e">---------------+------------------------------------------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span> <span style="color:#66d9ef">Table</span>         <span style="color:#f92672">|</span> <span style="color:#66d9ef">Create</span> <span style="color:#66d9ef">Table</span>                             <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">---------------+------------------------------------------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span> shard_table_1 <span style="color:#f92672">|</span> <span style="color:#66d9ef">CREATE</span> <span style="color:#66d9ef">TABLE</span> <span style="color:#f92672">`</span>shard_table_1<span style="color:#f92672">`</span> (
  <span style="color:#f92672">`</span>c1<span style="color:#f92672">`</span> int(<span style="color:#ae81ff">11</span>) <span style="color:#66d9ef">NOT</span> <span style="color:#66d9ef">NULL</span>,
  <span style="color:#f92672">`</span>c2<span style="color:#f92672">`</span> int(<span style="color:#ae81ff">11</span>) <span style="color:#66d9ef">DEFAULT</span> <span style="color:#66d9ef">NULL</span>,
  <span style="color:#66d9ef">PRIMARY</span> <span style="color:#66d9ef">KEY</span> (<span style="color:#f92672">`</span>c1<span style="color:#f92672">`</span>),
  <span style="color:#66d9ef">KEY</span> <span style="color:#f92672">`</span>idx_c2<span style="color:#f92672">`</span> (<span style="color:#f92672">`</span>c2<span style="color:#f92672">`</span>)
) ENGINE<span style="color:#f92672">=</span>InnoDB <span style="color:#66d9ef">DEFAULT</span> CHARSET<span style="color:#f92672">=</span>latin1 <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">---------------+------------------------------------------+</span></code></pre></div>
<p>Now, the following DDL statement is executed to all upstream sharded tables to alter the table schemas (namely, <code>DROP COLUMN c2</code>):</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">ALTER</span> <span style="color:#66d9ef">TABLE</span> shard_db_<span style="color:#f92672">*</span>.shard_table_<span style="color:#f92672">*</span> <span style="color:#66d9ef">DROP</span> <span style="color:#66d9ef">COLUMN</span> c2;</code></pre></div>
<p>When DM coordinates the two DM-workers to replicate this DDL statement through the sharding DDL lock and requests the DDL lock owner to execute the DDL statement to the downstream, because this DDL statement is not supported by TiDB, the replication task gets interrupted and report the following error:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">exec sqls<span style="color:#f92672">[[</span>USE <span style="color:#e6db74">`</span>shard_db<span style="color:#e6db74">`</span>; ALTER TABLE <span style="color:#e6db74">`</span>shard_db<span style="color:#e6db74">`</span>.<span style="color:#e6db74">`</span>shard_table<span style="color:#e6db74">`</span> DROP COLUMN <span style="color:#e6db74">`</span>c2<span style="color:#e6db74">`</span>;<span style="color:#f92672">]]</span> failed,
err:Error <span style="color:#ae81ff">1105</span>: can<span style="color:#960050;background-color:#1e0010">'</span>t drop column c2 with index covered now</code></pre></div>
<p><strong>Assume that you know in advance that this DDL statement is not supported by TiDB before it is executed in the upstream.</strong> Then you can use <code>sql-skip</code> or <code>sql-replace</code> to preset a skip or replace operation for this DDL statement.</p>
<p>For this particular DDL statement, because dropping columns with the index is not temporarily supported by TiDB, you can use two new SQL statements to replace the original DDL, namely, DROP the index first and then DROP the column c2.</p>
<h5 id="actively-replace-the-sql-statement-1">Actively replace the SQL statement</h5>
<ol>
<li><p>Design a matchable regular expression for the DDL statement (converted by the optional router-rule) to be executed in the upstream.</p>
<ul>
<li>The DDL statement to be executed in the upstream is <code>ALTER TABLE shard_db_*.shard_table_* DROP COLUMN c2</code>.</li>
<li><p>Because the table name should be converted into <code>`shard_db`.`shard_table`</code> by the router-rule, you can design the following regular expression:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#f92672">~</span>(<span style="color:#f92672">?</span>i)<span style="color:#66d9ef">ALTER</span><span style="color:#960050;background-color:#1e0010">\</span>s<span style="color:#f92672">+</span><span style="color:#66d9ef">TABLE</span><span style="color:#960050;background-color:#1e0010">\</span>s<span style="color:#f92672">+`</span>shard_db<span style="color:#f92672">`</span>.<span style="color:#f92672">`</span>shard_table<span style="color:#f92672">`</span><span style="color:#960050;background-color:#1e0010">\</span>s<span style="color:#f92672">+</span><span style="color:#66d9ef">DROP</span><span style="color:#960050;background-color:#1e0010">\</span>s<span style="color:#f92672">+</span><span style="color:#66d9ef">COLUMN</span><span style="color:#960050;background-color:#1e0010">\</span>s<span style="color:#f92672">+`</span>c2<span style="color:#f92672">`</span></code></pre></div></li>
</ul></li>
<li><p>Build new DDL statements that are used to replace this original DDL statement.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">ALTER</span> <span style="color:#66d9ef">TABLE</span> <span style="color:#f92672">`</span>shard_db<span style="color:#f92672">`</span>.<span style="color:#f92672">`</span>shard_table<span style="color:#f92672">`</span> <span style="color:#66d9ef">DROP</span> <span style="color:#66d9ef">INDEX</span> idx_c2;<span style="color:#66d9ef">ALTER</span> <span style="color:#66d9ef">TABLE</span> <span style="color:#f92672">`</span>shard_db<span style="color:#f92672">`</span>.<span style="color:#f92672">`</span>shard_table<span style="color:#f92672">`</span> <span style="color:#66d9ef">DROP</span> <span style="color:#66d9ef">COLUMN</span> <span style="color:#f92672">`</span>c2<span style="color:#f92672">`</span></code></pre></div></li>
<li><p>Because this is in the scenario of merging and replicating data from sharded tables, you can use <code>--sharding</code> to automatically guarantee that the replace operation is only executed in the DDL lock owner.</p></li>
<li><p>Use <code>sql-replace</code> to preset a replace operation that is to be executed when DM replicates the corresponding binlog event to the downstream.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">» sql-replace --sharding --sql-pattern<span style="color:#f92672">=</span>~<span style="color:#f92672">(</span>?i<span style="color:#f92672">)</span>ALTER<span style="color:#ae81ff">\s</span>+TABLE<span style="color:#ae81ff">\s</span>+<span style="color:#e6db74">`</span>shard_db<span style="color:#e6db74">`</span>.<span style="color:#e6db74">`</span>shard_table<span style="color:#e6db74">`</span><span style="color:#ae81ff">\s</span>+DROP<span style="color:#ae81ff">\s</span>+COLUMN<span style="color:#ae81ff">\s</span>+<span style="color:#e6db74">`</span>c2<span style="color:#e6db74">`</span> test ALTER TABLE <span style="color:#e6db74">`</span>shard_db<span style="color:#e6db74">`</span>.<span style="color:#e6db74">`</span>shard_table<span style="color:#e6db74">`</span> DROP INDEX idx_c2;ALTER TABLE <span style="color:#e6db74">`</span>shard_db<span style="color:#e6db74">`</span>.<span style="color:#e6db74">`</span>shard_table<span style="color:#e6db74">`</span> DROP COLUMN <span style="color:#e6db74">`</span>c2<span style="color:#e6db74">`</span>
 <span style="color:#f92672">{</span>
     <span style="color:#e6db74">"result"</span>: true,
     <span style="color:#e6db74">"msg"</span>: <span style="color:#e6db74">"request with --sharding saved and will be sent to DDL lock's owner when resolving DDL lock"</span>,
     <span style="color:#e6db74">"workers"</span>: <span style="color:#f92672">[</span>
     <span style="color:#f92672">]</span>
 <span style="color:#f92672">}</span></code></pre></div>
<p>You can also view the following log in the <strong>DM-master</strong> node:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#ae81ff">2018</span>/12/28 <span style="color:#ae81ff">16</span>:53:33 operator.go:105: <span style="color:#f92672">[</span>info<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>sql-operator<span style="color:#f92672">]</span> set a new operator 
uuid: eba35acd-6c5e-4bc3-b0b0-ae8bd1232351, request: name:<span style="color:#e6db74">"test"</span> 
op:REPLACE args:<span style="color:#e6db74">"ALTER TABLE `shard_db`.`shard_table` DROP INDEX idx_c2;"</span> 
args:<span style="color:#e6db74">"ALTER TABLE `shard_db`.`shard_table` DROP COLUMN `c2`"</span> 
sqlPattern:<span style="color:#e6db74">"~(?i)ALTER\\s+TABLE\\s+`shard_db`.`shard_table`\\s+DROP\\s+COLUMN\\s+`c2`"</span> 
sharding:true</code></pre></div></li>
<li><p>Execute the DDL statements to the sharded tables in the upstream MySQL instances.</p></li>
<li><p>Check if the downstream table schema is altered successfully, and you can also view the following log in the DDL lock <strong>owner</strong> node:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#ae81ff">2018</span>/12/28 <span style="color:#ae81ff">16</span>:54:35 operator.go:121: <span style="color:#f92672">[</span>info<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>sql-operator<span style="color:#f92672">]</span> set a new operator 
uuid: c959f2fb-f1c2-40c7-a1fa-e73cd51736dd, 
pattern: ~<span style="color:#f92672">(</span>?i<span style="color:#f92672">)</span>ALTER<span style="color:#ae81ff">\s</span>+TABLE<span style="color:#ae81ff">\s</span>+<span style="color:#e6db74">`</span>shard_db<span style="color:#e6db74">`</span>.<span style="color:#e6db74">`</span>shard_table<span style="color:#e6db74">`</span><span style="color:#ae81ff">\s</span>+DROP<span style="color:#ae81ff">\s</span>+COLUMN<span style="color:#ae81ff">\s</span>+<span style="color:#e6db74">`</span>c2<span style="color:#e6db74">`</span>, 
op: REPLACE, args: ALTER TABLE <span style="color:#e6db74">`</span>shard_db<span style="color:#e6db74">`</span>.<span style="color:#e6db74">`</span>shard_table<span style="color:#e6db74">`</span> DROP INDEX idx_c2; ALTER TABLE <span style="color:#e6db74">`</span>shard_db<span style="color:#e6db74">`</span>.<span style="color:#e6db74">`</span>shard_table<span style="color:#e6db74">`</span> DROP COLUMN <span style="color:#e6db74">`</span>c2<span style="color:#e6db74">`</span>
on replication unit</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#ae81ff">2018</span>/12/28 <span style="color:#ae81ff">16</span>:54:35 operator.go:158: <span style="color:#f92672">[</span>info<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>sql-operator<span style="color:#f92672">]</span> 
sql-pattern ~<span style="color:#f92672">(</span>?i<span style="color:#f92672">)</span>ALTER<span style="color:#ae81ff">\s</span>+TABLE<span style="color:#ae81ff">\s</span>+<span style="color:#e6db74">`</span>shard_db<span style="color:#e6db74">`</span>.<span style="color:#e6db74">`</span>shard_table<span style="color:#e6db74">`</span><span style="color:#ae81ff">\s</span>+DROP<span style="color:#ae81ff">\s</span>+COLUMN<span style="color:#ae81ff">\s</span>+<span style="color:#e6db74">`</span>c2<span style="color:#e6db74">`</span> matched SQL 
USE <span style="color:#e6db74">`</span>shard_db<span style="color:#e6db74">`</span>; ALTER TABLE <span style="color:#e6db74">`</span>shard_db<span style="color:#e6db74">`</span>.<span style="color:#e6db74">`</span>shard_table<span style="color:#e6db74">`</span> DROP COLUMN <span style="color:#e6db74">`</span>c2<span style="color:#e6db74">`</span>;, 
applying operator uuid: c959f2fb-f1c2-40c7-a1fa-e73cd51736dd, 
pattern: ~<span style="color:#f92672">(</span>?i<span style="color:#f92672">)</span>ALTER<span style="color:#ae81ff">\s</span>+TABLE<span style="color:#ae81ff">\s</span>+<span style="color:#e6db74">`</span>shard_db<span style="color:#e6db74">`</span>.<span style="color:#e6db74">`</span>shard_table<span style="color:#e6db74">`</span><span style="color:#ae81ff">\s</span>+DROP<span style="color:#ae81ff">\s</span>+COLUMN<span style="color:#ae81ff">\s</span>+<span style="color:#e6db74">`</span>c2<span style="color:#e6db74">`</span>, 
op: REPLACE, args: ALTER TABLE <span style="color:#e6db74">`</span>shard_db<span style="color:#e6db74">`</span>.<span style="color:#e6db74">`</span>shard_table<span style="color:#e6db74">`</span> DROP INDEX idx_c2; ALTER TABLE <span style="color:#e6db74">`</span>shard_db<span style="color:#e6db74">`</span>.<span style="color:#e6db74">`</span>shard_table<span style="color:#e6db74">`</span> DROP COLUMN <span style="color:#e6db74">`</span>c2<span style="color:#e6db74">`</span></code></pre></div>
<p>In addition, you can view the following log in the <strong>DM-master</strong> node:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#ae81ff">2018</span>/12/28 <span style="color:#ae81ff">16</span>:54:35 operator.go:122: <span style="color:#f92672">[</span>info<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>sql-operator<span style="color:#f92672">]</span> get an operator 
uuid: eba35acd-6c5e-4bc3-b0b0-ae8bd1232351, request: name:<span style="color:#e6db74">"test"</span> op:REPLACE 
args:<span style="color:#e6db74">"ALTER TABLE `shard_db`.`shard_table` DROP INDEX idx_c2;"</span> 
args:<span style="color:#e6db74">"ALTER TABLE `shard_db`.`shard_table` DROP COLUMN `c2`"</span> 
sqlPattern:<span style="color:#e6db74">"~(?i)ALTER\\s+TABLE\\s+`shard_db`.`shard_table`\\s+DROP\\s+COLUMN\\s+`c2`"</span> 
sharding:true  
with key ~<span style="color:#f92672">(</span>?i<span style="color:#f92672">)</span>ALTER<span style="color:#ae81ff">\s</span>+TABLE<span style="color:#ae81ff">\s</span>+<span style="color:#e6db74">`</span>shard_db<span style="color:#e6db74">`</span>.<span style="color:#e6db74">`</span>shard_table<span style="color:#e6db74">`</span><span style="color:#ae81ff">\s</span>+DROP<span style="color:#ae81ff">\s</span>+COLUMN<span style="color:#ae81ff">\s</span>+<span style="color:#e6db74">`</span>c2<span style="color:#e6db74">`</span> matched SQL 
USE <span style="color:#e6db74">`</span>shard_db<span style="color:#e6db74">`</span>; ALTER TABLE <span style="color:#e6db74">`</span>shard_db<span style="color:#e6db74">`</span>.<span style="color:#e6db74">`</span>shard_table<span style="color:#e6db74">`</span> DROP COLUMN <span style="color:#e6db74">`</span>c2<span style="color:#e6db74">`</span>;</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#ae81ff">2018</span>/12/28 <span style="color:#ae81ff">16</span>:54:36 operator.go:145: <span style="color:#f92672">[</span>info<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>sql-operator<span style="color:#f92672">]</span> remove an operator 
uuid: eba35acd-6c5e-4bc3-b0b0-ae8bd1232351, request: name:<span style="color:#e6db74">"test"</span> op:REPLACE 
args:<span style="color:#e6db74">"ALTER TABLE `shard_db`.`shard_table` DROP INDEX idx_c2;"</span> 
args:<span style="color:#e6db74">"ALTER TABLE `shard_db`.`shard_table` DROP COLUMN `c2`"</span> 
sqlPattern:<span style="color:#e6db74">"~(?i)ALTER\\s+TABLE\\s+`shard_db`.`shard_table`\\s+DROP\\s+COLUMN\\s+`c2`"</span> 
sharding:true</code></pre></div></li>
<li><p>Use <code>query-status</code> to guarantee that the <code>stage</code> of the task has been sustained as <code>Running</code>, and there is no more DDL statement that is blocking the replication (<code>blockingDDLs</code>) and no more sharding group to be resolved (<code>unresolvedGroups</code>).</p></li>
<li><p>Use <code>query-error</code> to guarantee that no DDL execution error exists.</p></li>
<li><p>Use <code>show-ddl-locks</code> to guarantee that all DDL locks have been resolved.</p></li>
</ol>
</div>
<div class="article-toc"></div>
<div class="git-info">
<a class="link" href="https://github.com/pingcap/docs/blob/master/tools/dm/skip-replace-sqls.md">"Skip or Replace Abnormal SQL Statements"</a>
                was last updated
                <span>Apr 24 2019</span>:
                <a class="link" href="https://github.com/pingcap/docs/commit/0cf5dddaa90da93c3d1ce7698e8c8f05839eb8e4">
                    *: update the Note format (#1079) <span class="hash">(0cf5ddd)</span>
</a>
</div></div>
<div class="sidebar-page">
<div class="sticky-sidebar"><a class="improve-doc" href="https://github.com/pingcap/docs/edit/master/tools/dm/skip-replace-sqls.md" target="_blank">
<svg fill="#142848" height="14" viewbox="0 0 275.836 275.836" width="14" xmlns="http://www.w3.org/2000/svg"><path d="M191.344 20.922l-95.155 95.155a5.99 5.99 0 0 0-1.565 2.734l-8.167 31.454a6.003 6.003 0 0 0 7.315 7.316l31.454-8.168a6.003 6.003 0 0 0 2.734-1.565l95.153-95.153.005-.004.004-.005 19.156-19.156a5.998 5.998 0 0 0 .001-8.484L218.994 1.758a5.998 5.998 0 0 0-8.485 0l-19.155 19.155-.005.004-.005.005zm-70.713 117.286l-19.993 5.192 5.191-19.993 89.762-89.762 14.801 14.802-89.761 89.761zm94.12-123.723l14.801 14.802-10.675 10.675-14.801-14.802 10.675-10.675z"></path><path d="M238.037 65.022a6 6 0 0 0-6 6v192.813H43.799V34.417h111.063a6 6 0 0 0 0-12H37.799a6 6 0 0 0-6 6v241.419a6 6 0 0 0 6 6h200.238a6 6 0 0 0 6-6V71.022a6 6 0 0 0-6-6z"></path></svg>
    Edit this page
</a>
<a class="request-docs-changes" href="https://github.com/pingcap/docs/issues/new?body=File:%20[tools%2fdm%2fskip-replace-sqls.md](https%3a%2f%2fpingcap.com%2fdocs%2ftools%2fdm%2fskip-replace-sqls%2f)" target="_blank">
<svg height="14px" version="1.1" viewbox="0 0 192 192" width="14px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g fill="none" fill-rule="nonzero" font-family="none" font-size="none" font-weight="none" stroke="none" stroke-dasharray="" stroke-dashoffset="0" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="10" stroke-width="1" style="mix-blend-mode: normal" text-anchor="none"><path d="M0,192v-192h192v192z" fill="none"></path><g fill="#142848"><path d="M162.34375,42.34375l-90.34375,90.34375l-34.34375,-34.34375l-11.3125,11.3125l45.65625,45.65625l101.65625,-101.65625z"></path></g></g></svg>

    Request docs changes
</a><p class="toc-title">What’s on this page</p>
<div id="smart_toc_wrapper"></div>
</div>
</div>
</div>
</div>
<footer>
<div class="container">
<div class="flex-list-wrap">
<div class="flex-list">
<h4 class="list-title"><strong>Product</strong></h4>
<ul>
<li><a href="/docs/">TiDB</a></li>
<li><a href="/docs/tispark/tispark-user-guide/">TiSpark</a></li>
<li><a href="/docs/ROADMAP/">Roadmap</a></li>
</ul>
</div>
<div class="flex-list">
<h4 class="list-title"><strong>Docs</strong></h4>
<ul>
<li><a href="/docs/op-guide/docker-compose/">Quick Start</a></li>
<li><a href="/blog/2017-07-24-tidbbestpractice/">Best Practices</a></li>
<li><a href="/docs/FAQ/">FAQ</a></li>
<li><a href="/docs/tools/syncer/">TiDB Utilities</a></li>
<li><a href="/docs/releases/rn/">Release Notes</a></li>
</ul>
</div>
<div class="flex-list">
<h4 class="list-title"><strong>Resources</strong></h4>
<ul>
<li><a href="/blog/">Blog</a></li>
<li><a href="/weekly/">Weekly</a></li>
<li><a href="https://github.com/pingcap" target="_blank">GitHub</a></li>
<li><a href="/community/">TiDB Community</a></li>
</ul>
</div>
<div class="flex-list">
<h4 class="list-title"><strong>Company</strong></h4>
<ul>
<li><a href="/about/">About</a></li>
<li><a href="https://angel.co/pingcap-1/jobs" target="_blank">Careers</a></li>
<li><a href="/news/">News</a></li>
<li><a href="/contact-us/">Contact Us</a></li>
<li><a href="/privacy-policy/">Privacy Policy</a></li>
<li><a href="/terms-of-service/">Terms of Service</a></li>
</ul>
</div>
</div>
<div class="contact-list-wrap">
<div class="flex-list">
<h4 class="list-title"><strong>Connect</strong></h4>
<ul>
<li><a class="twitter" href="https://twitter.com/PingCAP" target="_blank"><svg height="19" viewbox="0 0 612 612" width="18" xmlns="http://www.w3.org/2000/svg"><path d="M612 116.258a250.714 250.714 0 0 1-72.088 19.772c25.929-15.527 45.777-40.155 55.184-69.411-24.322 14.379-51.169 24.82-79.775 30.48-22.907-24.437-55.49-39.658-91.63-39.658-69.334 0-125.551 56.217-125.551 125.513 0 9.828 1.109 19.427 3.251 28.606-104.326-5.24-196.835-55.223-258.75-131.174-10.823 18.51-16.98 40.078-16.98 63.101 0 43.559 22.181 81.993 55.835 104.479a125.556 125.556 0 0 1-56.867-15.756v1.568c0 60.806 43.291 111.554 100.693 123.104-10.517 2.83-21.607 4.398-33.08 4.398-8.107 0-15.947-.803-23.634-2.333 15.985 49.907 62.336 86.199 117.253 87.194-42.947 33.654-97.099 53.655-155.916 53.655-10.134 0-20.116-.612-29.944-1.721 55.567 35.681 121.536 56.485 192.438 56.485 230.948 0 357.188-191.291 357.188-357.188l-.421-16.253c24.666-17.593 46.005-39.697 62.794-64.861z"></path></svg> Twitter</a></li>
<li><a class="linkedin" href="https://www.linkedin.com/company/pingcap/" target="_blank"><svg height="16" viewbox="0 0 438.536 438.535" width="18" xmlns="http://www.w3.org/2000/svg"><path d="M5.424 145.895H99.64v282.932H5.424zM408.842 171.739c-19.791-21.604-45.967-32.408-78.512-32.408-11.991 0-22.891 1.475-32.695 4.427-9.801 2.95-18.079 7.089-24.838 12.419-6.755 5.33-12.135 10.278-16.129 14.844-3.798 4.337-7.512 9.389-11.136 15.104v-40.232h-93.935l.288 13.706c.193 9.139.288 37.307.288 84.508 0 47.205-.19 108.777-.572 184.722h93.931V270.942c0-9.705 1.041-17.412 3.139-23.127 4-9.712 10.037-17.843 18.131-24.407 8.093-6.572 18.13-9.855 30.125-9.855 16.364 0 28.407 5.662 36.117 16.987 7.707 11.324 11.561 26.98 11.561 46.966V428.82h93.931V266.664c-.007-41.688-9.897-73.328-29.694-94.925zM53.103 9.708c-15.796 0-28.595 4.619-38.4 13.848C4.899 32.787 0 44.441 0 58.529 0 72.42 4.758 84.034 14.275 93.358c9.514 9.325 22.078 13.99 37.685 13.99h.571c15.99 0 28.887-4.661 38.688-13.99 9.801-9.324 14.606-20.934 14.417-34.829-.19-14.087-5.047-25.742-14.561-34.973C81.562 14.323 68.9 9.708 53.103 9.708z"></path></svg> LinkedIn</a></li>
<li><a class="reddit" href="https://www.reddit.com/r/TiDB/" target="_blank"><svg height="18" viewbox="0 0 279.748 279.748" width="18" xmlns="http://www.w3.org/2000/svg"><path d="M279.748 133.142c0-19.299-15.701-35-35-35-10.768 0-20.674 4.812-27.279 13.064-18.532-8.431-39.663-13.626-62.015-15.271l19.206-60.692 42.895 9.294c3.285 12.782 14.901 22.258 28.693 22.258 16.336 0 29.627-13.29 29.627-29.626 0-16.336-13.291-29.627-29.627-29.627-11.801 0-21.999 6.941-26.759 16.95l-49.497-10.725a10.002 10.002 0 0 0-11.651 6.756L134.636 95.43c-26.164.638-50.988 6.053-72.356 15.775-6.606-8.251-16.512-13.063-27.28-13.063-19.299 0-35 15.701-35 35 0 9.373 3.683 18.173 10.222 24.709-3.9 8.37-5.875 17.076-5.875 25.936 0 24.048 14.396 46.492 40.538 63.199 25.447 16.264 59.183 25.221 94.989 25.221 35.808 0 69.542-8.957 94.989-25.221 26.142-16.707 40.538-39.151 40.538-63.199 0-8.859-1.975-17.565-5.875-25.936 6.539-6.537 10.222-15.336 10.222-24.709zM15.369 145.139c-2.212-3.59-3.369-7.688-3.369-11.997 0-12.682 10.317-23 23-23 5.444 0 10.558 1.851 14.649 5.258-14.622 8.302-26.132 18.289-34.28 29.739zm52.671 20.266c0-13.785 11.215-25 25-25s25 11.215 25 25-11.215 25-25 25-25-11.215-25-25zm123.119 57.054c-9.745 10.637-29.396 17.244-51.285 17.244-21.888 0-41.539-6.607-51.284-17.244a9.937 9.937 0 0 1-2.617-7.192 9.933 9.933 0 0 1 3.235-6.937 9.974 9.974 0 0 1 6.754-2.627c2.797 0 5.484 1.183 7.373 3.244 5.803 6.333 20.827 10.756 36.539 10.756s30.737-4.423 36.539-10.756a10.022 10.022 0 0 1 7.374-3.244c2.508 0 4.906.933 6.755 2.627a9.928 9.928 0 0 1 3.234 6.937 9.933 9.933 0 0 1-2.617 7.192zm-4.451-32.054c-13.785 0-25-11.215-25-25s11.215-25 25-25 25 11.215 25 25-11.215 25-25 25zm77.671-45.266c-8.147-11.45-19.657-21.436-34.28-29.739 4.092-3.408 9.205-5.258 14.649-5.258 12.683 0 23 10.318 23 23 0 4.309-1.157 8.407-3.369 11.997z"></path></svg>Reddit</a></li>
<li><a class="google-plus" href="https://groups.google.com/forum/#!forum/tidb-user" target="_blank"><svg height="20" viewbox="0 0 491.858 491.858" width="18" xmlns="http://www.w3.org/2000/svg"><path d="M377.472 224.957H201.319v58.718H308.79c-16.032 51.048-63.714 88.077-120.055 88.077-69.492 0-125.823-56.335-125.823-125.824 0-69.492 56.333-125.823 125.823-125.823 34.994 0 66.645 14.289 89.452 37.346l42.622-46.328c-34.04-33.355-80.65-53.929-132.074-53.929C84.5 57.193 0 141.693 0 245.928s84.5 188.737 188.736 188.737c91.307 0 171.248-64.844 188.737-150.989v-58.718l-.001-.001zM491.858 224.857h-36.031v-36.031h-30.886v36.031H388.91v30.883h36.031v36.032h30.886V255.74h36.031z"></path></svg>Google Group</a></li>
<li><a class="stack-overflow" href="https://stackoverflow.com/questions/tagged/tidb" target="_blank"><svg height="17" viewbox="0 0 547.597 547.597" width="18" xmlns="http://www.w3.org/2000/svg"><path d="M140.81 475.111h.024l189.91-.269c8.434-.013 15.3-6.886 15.3-15.318v-21.298c0-8.428-6.854-15.288-15.3-15.288l-189.91.264c-8.433.012-15.3 6.885-15.3 15.318v21.31c.001 8.427 6.855 15.281 15.276 15.281z"></path><path d="M58.667 517.854c.073 29.26.073 29.449 3.072 29.449h.055l10.612.294h.086s85.814 0 171.629-.036c42.914-.019 85.821-.05 118-.092 16.09-.019 29.505-.043 38.887-.074 17.803-.055 17.803-.055 17.803-3.072l.3-10.697V333.299c0-8.434-6.866-15.3-15.3-15.3h-11.909c-8.434 0-15.3 6.866-15.3 15.3V496.22c0 5.062-4.119 9.18-9.181 9.18H110.51c-5.061 0-9.18-4.118-9.18-9.18V333.299c0-8.434-6.867-15.3-15.3-15.3H73.82c-8.433 0-15.3 6.86-15.3 15.3 0 23.342.012 76.084.055 122.981.019 23.447.05 45.442.092 61.574z"></path><path d="M142.322 397.399l189.402 17.467c.478.043.948.062 1.413.062 7.956 0 14.468-5.985 15.159-13.917l1.83-21.096c.729-8.396-5.508-15.851-13.898-16.628l-189.102-17.461c-8.593-.795-15.869 5.441-16.653 13.825l-1.97 21.108a15.172 15.172 0 0 0 3.452 11.181 15.19 15.19 0 0 0 10.367 5.459zM437.636 208.849a15.253 15.253 0 0 0 17.694 12.443l21.065-3.678c8.311-1.451 13.898-9.395 12.454-17.706l-32.504-187.23c-1.42-8.207-9.21-13.917-17.692-12.448l-21.065 3.678c-8.311 1.451-13.898 9.395-12.454 17.705l32.502 187.236zM190.333 194.375l163.6 96.708a15.28 15.28 0 0 0 7.778 2.136c5.393 0 10.447-2.876 13.183-7.509l10.876-18.36c2.08-3.519 2.674-7.631 1.658-11.591a15.18 15.18 0 0 0-7.032-9.358l-163.6-96.714c-7.014-4.149-16.836-1.597-20.967 5.374l-10.869 18.36a15.2 15.2 0 0 0-1.658 11.591 15.21 15.21 0 0 0 7.031 9.363zM387.525 240.501a15.276 15.276 0 0 0 12.626 6.659c3.091 0 6.077-.924 8.635-2.681l17.405-11.934c6.953-4.768 8.752-14.314 4.015-21.292L323.29 54.104c-4.584-6.732-14.498-8.623-21.236-3.984l-17.737 12.21c-6.945 4.779-8.727 14.327-3.971 21.291l107.179 156.88zM154.482 302.319l183.465 49.156c1.298.349 2.632.526 3.966.526 6.903 0 12.98-4.67 14.762-11.347l5.508-20.624c2.179-8.152-2.681-16.555-10.826-18.74l-183.465-49.162c-8.017-2.148-16.604 2.852-18.728 10.826l-5.508 20.63c-2.179 8.142 2.68 16.551 10.826 18.735z"></path></svg>Stack Overflow</a></li>
</ul>
</div>
<div class="subscribe">
<a href="https://share.hsforms.com/1e2W03wLJQQKPd1d9rCbj_Q2npzm"><button class="btn btn-subscribe f-tc">Subscribe to Blog</button></a>
</div>
</div>
</div>
<div class="container copyright-container">
<p class="copyright">© 2018 PingCAP. All Rights Reserved.</p>
<a class="copyright-btn-lang" href="/docs-cn/tools/dm/skip-replace-sqls" id="lang">中文</a>
</div>
</footer>
<button class="back-to-top" type="button"><svg height="512" viewbox="0 0 284.929 284.929" width="512" xmlns="http://www.w3.org/2000/svg"><path d="M282.082 195.285L149.028 62.24c-1.901-1.903-4.088-2.856-6.562-2.856s-4.665.953-6.567 2.856L2.856 195.285C.95 197.191 0 199.378 0 201.853c0 2.474.953 4.664 2.856 6.566l14.272 14.271c1.903 1.903 4.093 2.854 6.567 2.854s4.664-.951 6.567-2.854l112.204-112.202 112.208 112.209c1.902 1.903 4.093 2.848 6.563 2.848 2.478 0 4.668-.951 6.57-2.848l14.274-14.277c1.902-1.902 2.847-4.093 2.847-6.566.001-2.476-.944-4.666-2.846-6.569z" fill="#FFF"></path></svg>
</button>
</div>
<script type="text/javascript">document.getElementById("page-loader").style.display="none",document.getElementById("page-content").style.display="block"</script>
<div class="overlay"></div>
<script src="https://download.pingcap.com/js/jquery.min.js"></script><script src="/js/vendor/lazyload.min.js" type="text/javascript"></script>
<script src="/js/doc.js" type="text/javascript"></script>
<script src="/js/vendor/clipboard.min.js" type="text/javascript"></script><script src="https://download.pingcap.com/js/docsearch.min.js" type="text/javascript"></script>
<script src="/js/app.js" type="text/javascript"></script></body>
</html>
